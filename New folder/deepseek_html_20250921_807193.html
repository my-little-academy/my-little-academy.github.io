<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ® Ù…ØºØ§Ù…Ø±Ø© Ø§Ù„Ø·Ø±Ø­ Ø§Ù„Ù…Ù…ØªØ¹Ø©!</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap');
        
        body {
            font-family: 'Cairo', sans-serif;
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            text-align: center;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 500px;
            margin: auto;
            background: rgba(255, 255, 255, 0.95);
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            border: 3px solid #ff6b6b;
        }

        .header {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 20px;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header h1 {
            margin: 0;
            font-size: 28px;
        }

        .stats {
            display: flex;
            justify-content: space-around;
            margin: 15px 0;
            background: #f8f9fa;
            padding: 10px;
            border-radius: 10px;
            border: 2px solid #4ecdc4;
        }

        .stat-item {
            font-weight: bold;
        }

        .vertical-operation {
            font-size: 24px;
            margin: 20px auto;
            text-align: center;
            font-family: 'Courier New', monospace;
            position: relative;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            border: 2px dashed #ff6b6b;
        }

        .number-row {
            display: flex;
            justify-content: center;
            margin: 8px 0;
            position: relative;
        }

        .digit-box {
            width: 45px;
            height: 45px;
            border: 2px solid #4ecdc4;
            margin: 0 3px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #ffffff;
            border-radius: 8px;
            font-weight: bold;
            font-size: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .operator-box {
            width: 45px;
            height: 45px;
            margin: 0 3px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 24px;
            color: #ff6b6b;
        }

        .empty-box {
            width: 45px;
            height: 45px;
            margin: 0 3px;
            visibility: hidden;
        }

        .line {
            border-top: 3px solid #ff6b6b;
            margin: 12px auto;
            width: 180px;
        }

        .answer-digit {
            width: 45px;
            height: 45px;
            font-size: 20px;
            text-align: center;
            margin: 0 3px;
            border: 2px solid #4ecdc4;
            border-radius: 8px;
            background: #fff;
            font-weight: bold;
        }

        .answer-digit:focus {
            border-color: #ff6b6b;
            outline: none;
            box-shadow: 0 0 8px rgba(255, 107, 107, 0.3);
        }

        /* Ø®Ø§Ù†Ø§Øª Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù */
        .borrow-box {
            width: 30px;
            height: 30px;
            font-size: 16px;
            text-align: center;
            margin: 0 2px;
            border: 2px solid #fd7e14;
            border-radius: 6px;
            background-color: #fff3cd;
            font-weight: bold;
        }

        .borrow-row {
            display: flex;
            justify-content: center;
            margin: 5px 0;
            position: absolute;
            top: -35px;
            left: 0;
            right: 0;
        }

        .borrow-position {
            width: 45px;
            margin: 0 3px;
            display: flex;
            justify-content: center;
        }

        .buttons {
            margin: 20px 0;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        button {
            padding: 12px 25px;
            font-size: 16px;
            background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            flex: 1;
            min-width: 120px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }

        button:active {
            transform: translateY(0);
        }

        button.secondary {
            background: linear-gradient(135deg, #fd7e14 0%, #fdb750 100%);
        }

        .feedback {
            margin-top: 20px;
            font-size: 20px;
            font-weight: bold;
            min-height: 40px;
            padding: 15px;
            border-radius: 15px;
            transition: all 0.5s ease;
        }

        .correct {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            color: #155724;
            border: 2px solid #c3e6cb;
            animation: celebrate 0.5s ease-in-out;
        }

        .incorrect {
            background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);
            color: #721c24;
            border: 2px solid #f5c6cb;
        }

        .explanation {
            margin-top: 15px;
            font-size: 16px;
            color: #555;
            text-align: right;
            direction: rtl;
            background: #e9ecef;
            padding: 15px;
            border-radius: 10px;
            border-right: 4px solid #4ecdc4;
        }

        /* Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© */
        .answer-card {
            background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
            color: white;
            padding: 15px;
            border-radius: 15px;
            margin-top: 15px;
            font-weight: bold;
            display: none;
        }

        /* Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØµØ¹ÙˆØ¨Ø© */
        .difficulty {
            margin: 15px 0;
            background: #e9ecef;
            padding: 10px;
            border-radius: 10px;
        }

        .difficulty-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 10px;
        }

        .difficulty-btn {
            padding: 8px 15px;
            border: 2px solid #4ecdc4;
            border-radius: 20px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .difficulty-btn.active {
            background: #4ecdc4;
            color: white;
        }

        /* Animations */
        @keyframes celebrate {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        @keyframes confetti {
            0% { transform: translateY(0) rotate(0); opacity: 1; }
            100% { transform: translateY(100px) rotate(360deg); opacity: 0; }
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #ff6b6b;
            animation: confetti 1s ease-in-out;
        }

        .emoji {
            font-size: 24px;
            margin: 0 5px;
        }

        .progress-bar {
            height: 10px;
            background: #e9ecef;
            border-radius: 5px;
            margin: 10px 0;
            overflow: hidden;
        }

        .progress {
            height: 100%;
            background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
            width: 0%;
            transition: width 0.5s ease;
        }

        @media (max-width: 480px) {
            .container {
                padding: 15px;
            }
            .digit-box, .answer-digit, .operator-box {
                width: 40px;
                height: 40px;
                font-size: 18px;
            }
            button {
                padding: 10px 20px;
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ® Ù…ØºØ§Ù…Ø±Ø© Ø§Ù„Ø·Ø±Ø­ Ø§Ù„Ù…Ù…ØªØ¹Ø©! ğŸ§®</h1>
            <div class="stats">
                <div class="stat-item">Ø§Ù„Ù†Ù‚Ø§Ø·: <span id="score">0</span></div>
                <div class="stat-item">Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª: <span id="attempts">0</span></div>
                <div class="stat-item">Ø§Ù„ØµØ­ÙŠØ­: <span id="correctCount">0</span></div>
            </div>
            <div class="progress-bar">
                <div class="progress" id="progress"></div>
            </div>
        </div>

        <div class="difficulty">
            <div>Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØµØ¹ÙˆØ¨Ø©:</div>
            <div class="difficulty-buttons">
                <button class="difficulty-btn active" onclick="setDifficulty('easy')">Ø³Ù‡Ù„ ğŸŸ¢</button>
                <button class="difficulty-btn" onclick="setDifficulty('medium')">Ù…ØªÙˆØ³Ø· ğŸŸ¡</button>
                <button class="difficulty-btn" onclick="setDifficulty('hard')">ØµØ¹Ø¨ ğŸ”´</button>
            </div>
        </div>
        
        <div class="vertical-operation">
            <!-- Ø®Ø§Ù†Ø§Øª Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù -->
            <div class="borrow-row">
                <div class="borrow-position">
                    <input type="number" class="borrow-box" id="borrow-hundreds" min="0" max="1" placeholder="0">
                </div>
                <div class="borrow-position">
                    <input type="number" class="borrow-box" id="borrow-tens" min="0" max="1" placeholder="0" oninput="moveToNext(this, 'borrow-units')">
                </div>
                <div class="borrow-position">
                    <input type="number" class="borrow-box" id="borrow-units" min="0" max="1" placeholder="0" oninput="moveToNext(this, 'ans-hundreds')">
                </div>
                <div class="borrow-position"></div>
            </div>
            
            <!-- Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙˆÙ„ (Ø§Ù„Ù…Ø·Ø±ÙˆØ­ Ù…Ù†Ù‡) -->
            <div class="number-row">
                <div class="empty-box"></div>
                <div class="digit-box" id="num1-hundreds">0</div>
                <div class="digit-box" id="num1-tens">0</div>
                <div class="digit-box" id="num1-units">0</div>
            </div>
            
            <!-- Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø«Ø§Ù†ÙŠ (Ø§Ù„Ù…Ø·Ø±ÙˆØ­) Ù…Ø¹ Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ø·Ø±Ø­ -->
            <div class="number-row">
                <div class="operator-box">-</div>
                <div class="digit-box" id="num2-hundreds">0</div>
                <div class="digit-box" id="num2-tens">0</div>
                <div class="digit-box" id="num2-units">0</div>
            </div>
            
            <!-- Ø§Ù„Ø®Ø· Ø§Ù„ÙØ§ØµÙ„ -->
            <div class="line"></div>
            
            <!-- Ø®Ø§Ù†Ø§Øª Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© -->
            <div class="number-row">
                <div class="empty-box"></div>
                <input type="number" class="answer-digit" id="ans-hundreds" min="0" max="9" oninput="moveToNext(this, 'ans-tens')">
                <input type="number" class="answer-digit" id="ans-tens" min="0" max="9" oninput="moveToNext(this, 'ans-units')">
                <input type="number" class="answer-digit" id="ans-units" min="0" max="9">
            </div>
        </div>
        
        <div class="buttons">
            <button id="checkBtn">âœ… ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©</button>
            <button id="generateBtn" class="secondary">ğŸ”„ Ù…Ø³Ø£Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©</button>
            <button id="hintBtn" onclick="showHint()">ğŸ’¡ ØªÙ„Ù…ÙŠØ­</button>
        </div>
        
        <div class="feedback" id="feedback">Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© ÙˆØ§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚!</div>
        
        <!-- Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© -->
        <div class="answer-card" id="answerCard">
            <span class="emoji">ğŸ¯</span>
            Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©: <span id="correctAnswer">0</span>
            <span class="emoji">ğŸ¯</span>
        </div>
        
        <div class="explanation" id="explanation"></div>
    </div>

    <script>
        let currentDifficulty = 'easy';
        let score = 0;
        let attempts = 0;
        let correctCount = 0;
        let currentProblem = {};
        let correctBorrowValues = {};

        document.addEventListener('DOMContentLoaded', function() {
            const generateBtn = document.getElementById('generateBtn');
            const checkBtn = document.getElementById('checkBtn');
            
            generateBtn.addEventListener('click', generateProblem);
            checkBtn.addEventListener('click', checkAnswer);

            // ØªÙˆÙ„ÙŠØ¯ Ù…Ø³Ø£Ù„Ø© Ø£ÙˆÙ„ÙŠØ© Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
            generateProblem();
        });

        function setDifficulty(level) {
            currentDifficulty = level;
            document.querySelectorAll('.difficulty-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`.difficulty-btn:nth-child(${level === 'easy' ? 1 : level === 'medium' ? 2 : 3})`).classList.add('active');
            generateProblem();
        }

        function generateProblem() {
            let num1, num2;
            
            if (currentDifficulty === 'easy') {
                // Ø£Ø¹Ø¯Ø§Ø¯ ØµØºÙŠØ±Ø© Ø¨Ø¯ÙˆÙ† Ø§Ø³ØªÙ„Ø§Ù Ø£Ùˆ Ù…Ø¹ Ø§Ø³ØªÙ„Ø§Ù Ø¨Ø³ÙŠØ·
                num1 = Math.floor(Math.random() * 200) + 100;
                num2 = Math.floor(Math.random() * (num1 - 10)) + 10;
            } else if (currentDifficulty === 'medium') {
                // Ø£Ø¹Ø¯Ø§Ø¯ Ù…ØªÙˆØ³Ø·Ø© Ù…Ø¹ Ø§Ø³ØªÙ„Ø§Ù
                num1 = Math.floor(Math.random() * 500) + 200;
                num2 = Math.floor(Math.random() * (num1 - 100)) + 100;
                // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ø³ØªÙ„Ø§Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ ÙÙŠ Ø®Ø§Ù†Ø© ÙˆØ§Ø­Ø¯Ø©
                while (!hasBorrow(num1, num2)) {
                    num1 = Math.floor(Math.random() * 500) + 200;
                    num2 = Math.floor(Math.random() * (num1 - 100)) + 100;
                }
            } else {
                // Ø£Ø¹Ø¯Ø§Ø¯ ÙƒØ¨ÙŠØ±Ø© Ù…Ø¹ Ø§Ø³ØªÙ„Ø§Ù Ù…ØªØ¹Ø¯Ø¯
                num1 = Math.floor(Math.random() * 900) + 100;
                num2 = Math.floor(Math.random() * (num1 - 100)) + 100;
                // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ø³ØªÙ„Ø§Ù Ù…ØªØ¹Ø¯Ø¯
                while (!hasMultipleBorrows(num1, num2)) {
                    num1 = Math.floor(Math.random() * 900) + 100;
                    num2 = Math.floor(Math.random() * (num1 - 100)) + 100;
                }
            }

            calculateCorrectBorrowValues(num1, num2);

            currentProblem = { 
                num1, 
                num2, 
                answer: num1 - num2
            };
            
            displayProblem(num1, num2);
            clearInputs();
            clearFeedback();
            hideAnswerCard();
            focusFirstInput();
        }

        function calculateCorrectBorrowValues(a, b) {
            correctBorrowValues = { units: 0, tens: 0, hundreds: 0 };
            
            let unitsA = a % 10;
            let tensA = Math.floor(a / 10) % 10;
            let hundredsA = Math.floor(a / 100);
            
            let unitsB = b % 10;
            let tensB = Math.floor(b / 10) % 10;
            let hundredsB = Math.floor(b / 100);
            
            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù Ù„Ù„ÙˆØ­Ø¯Ø§Øª
            if (unitsA < unitsB) {
                correctBorrowValues.units = 1;
                unitsA += 10;
                tensA -= 1;
            }
            
            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù Ù„Ù„Ø¹Ø´Ø±Ø§Øª
            if (tensA < tensB) {
                correctBorrowValues.tens = 1;
                tensA += 10;
                hundredsA -= 1;
            }
            
            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù Ù„Ù„Ù…Ø¦Ø§Øª
            if (hundredsA < hundredsB) {
                correctBorrowValues.hundreds = 1;
            }
        }

        function hasBorrow(a, b) {
            const unitsA = a % 10;
            const tensA = Math.floor(a / 10) % 10;
            
            const unitsB = b % 10;
            const tensB = Math.floor(b / 10) % 10;
            
            return unitsA < unitsB || tensA < tensB;
        }

        function hasMultipleBorrows(a, b) {
            const unitsA = a % 10;
            const tensA = Math.floor(a / 10) % 10;
            const hundredsA = Math.floor(a / 100);
            
            const unitsB = b % 10;
            const tensB = Math.floor(b / 10) % 10;
            const hundredsB = Math.floor(b / 100);
            
            return (unitsA < unitsB && tensA <= tensB) || (tensA < tensB && hundredsA <= hundredsB);
        }

        function displayProblem(num1, num2) {
            document.getElementById('num1-hundreds').textContent = Math.floor(num1 / 100);
            document.getElementById('num1-tens').textContent = Math.floor((num1 % 100) / 10);
            document.getElementById('num1-units').textContent = num1 % 10;
            
            document.getElementById('num2-hundreds').textContent = Math.floor(num2 / 100);
            document.getElementById('num2-tens').textContent = Math.floor((num2 % 100) / 10);
            document.getElementById('num2-units').textContent = num2 % 10;
        }

        function clearInputs() {
            document.getElementById('ans-hundreds').value = '';
            document.getElementById('ans-tens').value = '';
            document.getElementById('ans-units').value = '';
            document.getElementById('borrow-hundreds').value = '';
            document.getElementById('borrow-tens').value = '';
            document.getElementById('borrow-units').value = '';
        }

        function clearFeedback() {
            document.getElementById('feedback').textContent = 'Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© ÙˆØ§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚!';
            document.getElementById('feedback').className = 'feedback';
            document.getElementById('explanation').textContent = '';
        }

        function hideAnswerCard() {
            document.getElementById('answerCard').style.display = 'none';
        }

        function showAnswerCard() {
            document.getElementById('correctAnswer').textContent = currentProblem.answer;
            document.getElementById('answerCard').style.display = 'block';
        }

        function focusFirstInput() {
            document.getElementById('borrow-units').focus();
        }

        function checkAnswer() {
            const userAnswer = parseInt(document.getElementById('ans-hundreds').value || 0) * 100 + 
                              parseInt(document.getElementById('ans-tens').value || 0) * 10 + 
                              parseInt(document.getElementById('ans-units').value || 0);
            
            const userBorrowUnits = parseInt(document.getElementById('borrow-units').value || 0);
            const userBorrowTens = parseInt(document.getElementById('borrow-tens').value || 0);
            const userBorrowHundreds = parseInt(document.getElementById('borrow-hundreds').value || 0);
            
            const isAnswerCorrect = userAnswer === currentProblem.answer;
            const isBorrowCorrect = userBorrowUnits === correctBorrowValues.units &&
                                  userBorrowTens === correctBorrowValues.tens &&
                                  userBorrowHundreds === correctBorrowValues.hundreds;
            
            attempts++;
            document.getElementById('attempts').textContent = attempts;
            
            if (isAnswerCorrect && isBorrowCorrect) {
                score += currentDifficulty === 'easy' ? 5 : currentDifficulty === 'medium' ? 10 : 15;
                correctCount++;
                document.getElementById('score').textContent = score;
                document.getElementById('correctCount').textContent = correctCount;
                
                // ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…
                const progress = (correctCount / attempts) * 100;
                document.getElementById('progress').style.width = progress + '%';
                
                showFeedback('ğŸ‰ Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©! Ø£Ø­Ø³Ù†Øª! ğŸŒŸ', 'correct');
                createConfetti();
                document.getElementById('explanation').textContent = '';
                
                setTimeout(generateProblem, 2000);
            } else {
                showFeedback('âŒ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ ØªØµØ­ÙŠØ­', 'incorrect');
                showAnswerCard();
                showExplanation();
            }
        }

        function showHint() {
            const hintMessage = `
                ğŸ’¡ ØªÙ„Ù…ÙŠØ­: 
                - Ø§Ø¨Ø¯Ø£ Ø¨Ø·Ø±Ø­ Ø§Ù„ÙˆØ­Ø¯Ø§Øª Ø£ÙˆÙ„Ø§Ù‹: ${currentProblem.num1 % 10} - ${currentProblem.num2 % 10}
                - Ø«Ù… Ø§Ù„Ø¹Ø´Ø±Ø§Øª: ${Math.floor((currentProblem.num1 % 100) / 10)} - ${Math.floor((currentProblem.num2 % 100) / 10)}
                - Ø«Ù… Ø§Ù„Ù…Ø¦Ø§Øª: ${Math.floor(currentProblem.num1 / 100)} - ${Math.floor(currentProblem.num2 / 100)}
                - ØªØ°ÙƒØ± Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù Ø¹Ù†Ø¯Ù…Ø§ ÙŠÙƒÙˆÙ† Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø¹Ù„ÙˆÙŠ Ø£ØµØºØ± Ù…Ù† Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³ÙÙ„ÙŠ
            `;
            document.getElementById('feedback').textContent = hintMessage;
            document.getElementById('feedback').className = 'feedback';
        }

        function showFeedback(message, className) {
            const feedbackEl = document.getElementById('feedback');
            feedbackEl.textContent = message;
            feedbackEl.className = `feedback ${className}`;
        }

        function showExplanation() {
            let explanationText = `
                <p>ğŸ§® Ø´Ø±Ø­ Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø­Ù„:</p>
                <p>ğŸ”¹ Ø§Ø¨Ø¯Ø£ Ù…Ù† Ø§Ù„ÙŠÙ…ÙŠÙ† (Ø§Ù„ÙˆØ­Ø¯Ø§Øª):</p>
            `;
            
            let unitsA = currentProblem.num1 % 10;
            let tensA = Math.floor(currentProblem.num1 / 10) % 10;
            let hundredsA = Math.floor(currentProblem.num1 / 100);
            
            let unitsB = currentProblem.num2 % 10;
            let tensB = Math.floor(currentProblem.num2 / 10) % 10;
            let hundredsB = Math.floor(currentProblem.num2 / 100);
            
            // Ø´Ø±Ø­ Ø§Ù„ÙˆØ­Ø¯Ø§Øª
            if (unitsA < unitsB) {
                explanationText += `<p>   - ${unitsA} Ø£ØµØºØ± Ù…Ù† ${unitsB}ØŒ Ù„Ø°Ù„Ùƒ Ù†Ø³ØªÙ„Ù 1 Ù…Ù† Ø§Ù„Ø¹Ø´Ø±Ø§Øª</p>`;
                explanationText += `<p>   - ØªØµØ¨Ø­ Ø§Ù„ÙˆØ­Ø¯Ø§Øª: ${unitsA + 10} - ${unitsB} = ${unitsA + 10 - unitsB}</p>`;
                tensA -= 1;
            } else {
                explanationText += `<p>   - ${unitsA} - ${unitsB} = ${unitsA - unitsB}</p>`;
            }
            
            // Ø´Ø±Ø­ Ø§Ù„Ø¹Ø´Ø±Ø§Øª
            explanationText += `<p>ğŸ”¹ Ø«Ù… Ø§Ù„Ø¹Ø´Ø±Ø§Øª:</p>`;
            if (tensA < tensB) {
                explanationText += `<p>   - ${tensA} Ø£ØµØºØ± Ù…Ù† ${tensB}ØŒ Ù„Ø°Ù„Ùƒ Ù†Ø³ØªÙ„Ù 1 Ù…Ù† Ø§Ù„Ù…Ø¦Ø§Øª</p>`;
                explanationText += `<p>   - ØªØµØ¨Ø­ Ø§Ù„Ø¹Ø´Ø±Ø§Øª: ${tensA + 10} - ${tensB} = ${tensA + 10 - tensB}</p>`;
                hundredsA -= 1;
            } else {
                explanationText += `<p>   - ${tensA} - ${tensB} = ${tensA - tensB}</p>`;
            }
            
            // Ø´Ø±Ø­ Ø§Ù„Ù…Ø¦Ø§Øª
            explanationText += `<p>ğŸ”¹ Ø«Ù… Ø§Ù„Ù…Ø¦Ø§Øª:</p>`;
            explanationText += `<p>   - ${hundredsA} - ${hundredsB} = ${hundredsA - hundredsB}</p>`;
            
            explanationText += `<p>ğŸ”¹ Ø§Ù„Ù†Ø§ØªØ¬ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ: ${currentProblem.answer}</p>`;
            
            document.getElementById('explanation').innerHTML = explanationText;
        }

        function createConfetti() {
            for (let i = 0; i < 30; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + '%';
                confetti.style.background = ['#ff6b6b', '#4ecdc4', '#ffd166', '#06d6a0', '#118ab2'][Math.floor(Math.random() * 5)];
                confetti.style.animationDelay = Math.random() * 0.5 + 's';
                document.body.appendChild(confetti);
                
                setTimeout(() => {
                    confetti.remove();
                }, 1000);
            }
        }

        function moveToNext(current, nextFieldId) {
            if (current.value.length === current.maxLength) {
                document.getElementById(nextFieldId).focus();
            }
        }
    </script>
</body>
</html>