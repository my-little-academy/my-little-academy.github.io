<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„Ø¹Ø¨Ø© ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø¬Ù…Ø¹ Ù„Ù„Ø£Ø·ÙØ§Ù„</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f0f8ff;
            text-align: center;
            margin: 0;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 600px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            color: #4b6cb7;
            margin-bottom: 30px;
        }
        
        .problem {
            font-size: 24px;
            margin: 30px 0;
            direction: ltr;
            text-align: center;
            display: inline-block;
        }
        
        .digit {
            display: inline-block;
            width: 40px;
            text-align: center;
            margin: 0 5px;
        }
        
        .carry {
            font-size: 14px;
            color: #ff6b6b;
            height: 20px;
            vertical-align: top;
        }
        
        .line {
            border-top: 2px solid #4b6cb7;
            margin: 5px 0;
            width: 100px;
            display: inline-block;
        }
        
        input {
            width: 40px;
            height: 40px;
            font-size: 20px;
            text-align: center;
            margin: 0 5px;
            border: 2px solid #ddd;
            border-radius: 5px;
        }
        
        input:focus {
            border-color: #4b6cb7;
            outline: none;
        }
        
        button {
            background-color: #4b6cb7;
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 16px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: #3a56a0;
        }
        
        .feedback {
            font-size: 20px;
            margin: 20px 0;
            min-height: 30px;
        }
        
        .correct {
            color: #2ecc71;
        }
        
        .incorrect {
            color: #e74c3c;
        }
        
        .explanation {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            text-align: right;
            display: none;
        }
        
        .stars {
            font-size: 30px;
            margin: 20px 0;
            color: #f1c40f;
        }
        
        .carry-box {
            display: inline-block;
            width: 40px;
            height: 20px;
            margin: 0 5px;
        }
        
        .controls {
            margin: 20px 0;
        }
        
        .level-selector {
            margin: 15px 0;
        }
        
        select {
            padding: 8px;
            border-radius: 5px;
            border: 2px solid #ddd;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ® Ù„Ø¹Ø¨Ø© ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø¬Ù…Ø¹ Ù…Ø¹ Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ ğŸ®</h1>
        
        <div class="level-selector">
            <label for="level">Ø§Ø®ØªØ± Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØµØ¹ÙˆØ¨Ø©:</label>
            <select id="level">
                <option value="1">Ù…Ø¨ØªØ¯Ø¦ (Ø¬Ù…Ø¹ Ø¨Ø¯ÙˆÙ† Ø§Ø­ØªÙØ§Ø¸)</option>
                <option value="2">Ù…ØªÙˆØ³Ø· (Ø¬Ù…Ø¹ Ù…Ø¹ Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø³ÙŠØ·)</option>
                <option value="3">Ù…ØªÙ‚Ø¯Ù… (Ø¬Ù…Ø¹ Ù…Ø¹ Ø§Ø­ØªÙØ§Ø¸ Ù…ØªØ¹Ø¯Ø¯)</option>
            </select>
        </div>
        
        <div class="problem-area">
            <div class="carry-row">
                <span class="carry-box" id="carry-hundreds"></span>
                <span class="carry-box" id="carry-tens"></span>
                <span class="carry-box" id="carry-ones"></span>
            </div>
            <div class="problem">
                <div>
                    <span class="digit" id="num1-hundreds"></span>
                    <span class="digit" id="num1-tens"></span>
                    <span class="digit" id="num1-ones"></span>
                </div>
                <div>
                    <span class="digit">+</span>
                    <span class="digit" id="num2-hundreds"></span>
                    <span class="digit" id="num2-tens"></span>
                    <span class="digit" id="num2-ones"></span>
                </div>
                <div class="line"></div>
                <div>
                    <span class="digit">
                        <input type="text" id="answer-hundreds" maxlength="1">
                    </span>
                    <span class="digit">
                        <input type="text" id="answer-tens" maxlength="1">
                    </span>
                    <span class="digit">
                        <input type="text" id="answer-ones" maxlength="1">
                    </span>
                </div>
            </div>
        </div>
        
        <div class="feedback"></div>
        
        <div class="controls">
            <button id="check-btn">ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©</button>
            <button id="new-problem">Ù…Ø³Ø£Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©</button>
            <button id="help-btn">Ù…Ø³Ø§Ø¹Ø¯Ø©</button>
        </div>
        
        <div class="explanation" id="explanation"></div>
        
        <div class="stars">â˜…â˜…â˜…â˜…â˜…</div>
        <div>Ø¹Ø¯Ø¯ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø©: <span id="score">0</span></div>
    </div>

    <script>
        let score = 0;
        let currentProblem = { num1: 0, num2: 0 };
        let level = 1;
        
        const elements = {
            level: document.getElementById('level'),
            num1Hundreds: document.getElementById('num1-hundreds'),
            num1Tens: document.getElementById('num1-tens'),
            num1Ones: document.getElementById('num1-ones'),
            num2Hundreds: document.getElementById('num2-hundreds'),
            num2Tens: document.getElementById('num2-tens'),
            num2Ones: document.getElementById('num2-ones'),
            answerHundreds: document.getElementById('answer-hundreds'),
            answerTens: document.getElementById('answer-tens'),
            answerOnes: document.getElementById('answer-ones'),
            carryHundreds: document.getElementById('carry-hundreds'),
            carryTens: document.getElementById('carry-tens'),
            carryOnes: document.getElementById('carry-ones'),
            feedback: document.querySelector('.feedback'),
            explanation: document.getElementById('explanation'),
            score: document.getElementById('score'),
            stars: document.querySelector('.stars'),
            checkBtn: document.getElementById('check-btn'),
            newProblemBtn: document.getElementById('new-problem'),
            helpBtn: document.getElementById('help-btn')
        };
        
        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©
        function init() {
            elements.level.addEventListener('change', function() {
                level = parseInt(this.value);
                generateProblem();
            });
            
            elements.checkBtn.addEventListener('click', checkAnswer);
            elements.newProblemBtn.addEventListener('click', generateProblem);
            elements.helpBtn.addEventListener('click', showHelp);
            
            // Ø§Ù„Ø³Ù…Ø§Ø­ ÙÙ‚Ø· Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø£Ø±Ù‚Ø§Ù…
            document.querySelectorAll('input').forEach(input => {
                input.addEventListener('input', function() {
                    this.value = this.value.replace(/[^0-9]/g, '');
                });
            });
            
            generateProblem();
        }
        
        // ØªÙˆÙ„ÙŠØ¯ Ù…Ø³Ø£Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©
        function generateProblem() {
            // Ù…Ø³Ø­ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
            elements.answerHundreds.value = '';
            elements.answerTens.value = '';
            elements.answerOnes.value = '';
            elements.carryHundreds.textContent = '';
            elements.carryTens.textContent = '';
            elements.carryOnes.textContent = '';
            elements.feedback.textContent = '';
            elements.feedback.className = 'feedback';
            elements.explanation.style.display = 'none';
            
            // ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ Ø­Ø³Ø¨ Ø§Ù„Ù…Ø³ØªÙˆÙ‰
            if (level === 1) {
                // Ø¬Ù…Ø¹ Ø¨Ø¯ÙˆÙ† Ø§Ø­ØªÙØ§Ø¸ (Ù…Ø¬Ù…ÙˆØ¹ ÙƒÙ„ Ø®Ø§Ù†Ø© Ø£Ù‚Ù„ Ù…Ù† 10)
                currentProblem.num1 = Math.floor(Math.random() * 40) + 10;
                currentProblem.num2 = Math.floor(Math.random() * (99 - currentProblem.num1)) + 1;
                
                // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ø§Ø­ØªÙØ§Ø¸ ÙÙŠ Ø£ÙŠ Ø®Ø§Ù†Ø©
                while (hasCarry(currentProblem.num1, currentProblem.num2)) {
                    currentProblem.num1 = Math.floor(Math.random() * 40) + 10;
                    currentProblem.num2 = Math.floor(Math.random() * (99 - currentProblem.num1)) + 1;
                }
            } else if (level === 2) {
                // Ø¬Ù…Ø¹ Ù…Ø¹ Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø³ÙŠØ· (Ø§Ø­ØªÙØ§Ø¸ ÙÙŠ Ø®Ø§Ù†Ø© ÙˆØ§Ø­Ø¯Ø©)
                currentProblem.num1 = Math.floor(Math.random() * 80) + 10;
                currentProblem.num2 = Math.floor(Math.random() * 80) + 10;
                
                // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ø­ØªÙØ§Ø¸ ÙÙŠ Ø®Ø§Ù†Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø·
                while (!hasSingleCarry(currentProblem.num1, currentProblem.num2)) {
                    currentProblem.num1 = Math.floor(Math.random() * 80) + 10;
                    currentProblem.num2 = Math.floor(Math.random() * 80) + 10;
                }
            } else {
                // Ø¬Ù…Ø¹ Ù…Ø¹ Ø§Ø­ØªÙØ§Ø¸ Ù…ØªØ¹Ø¯Ø¯
                currentProblem.num1 = Math.floor(Math.random() * 900) + 100;
                currentProblem.num2 = Math.floor(Math.random() * 900) + 100;
            }
            
            displayProblem();
        }
        
        // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø³Ø£Ù„Ø©
        function displayProblem() {
            const num1 = currentProblem.num1.toString().padStart(3, '0');
            const num2 = currentProblem.num2.toString().padStart(3, '0');
            
            elements.num1Hundreds.textContent = num1[0];
            elements.num1Tens.textContent = num1[1];
            elements.num1Ones.textContent = num1[2];
            
            elements.num2Hundreds.textContent = num2[0];
            elements.num2Tens.textContent = num2[1];
            elements.num2Ones.textContent = num2[2];
            
            // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø®Ø§Ù†Ø§Øª ØºÙŠØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© Ù„Ù„Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„Ø¨Ø³ÙŠØ·Ø©
            if (level === 1 || level === 2) {
                elements.num1Hundreds.textContent = '';
                elements.num2Hundreds.textContent = '';
                elements.answerHundreds.style.visibility = 'hidden';
            } else {
                elements.answerHundreds.style.visibility = 'visible';
            }
        }
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©
        function checkAnswer() {
            const userAnswer = parseInt(
                (elements.answerHundreds.value || '0') + 
                (elements.answerTens.value || '0') + 
                elements.answerOnes.value
            );
            
            const correctAnswer = currentProblem.num1 + currentProblem.num2;
            
            if (userAnswer === correctAnswer) {
                elements.feedback.textContent = 'Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©! Ø£Ø­Ø³Ù†Øª! ğŸŒŸ';
                elements.feedback.className = 'feedback correct';
                score++;
                elements.score.textContent = score;
                updateStars();
                
                // Ø¹Ø±Ø¶ Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø­Ù„
                showExplanation(true);
            } else {
                elements.feedback.textContent = 'Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰! ğŸ’ª';
                elements.feedback.className = 'feedback incorrect';
                showExplanation(false);
            }
        }
        
        // Ø¹Ø±Ø¶ Ø§Ù„Ø´Ø±Ø­
        function showExplanation(isCorrect) {
            const num1 = currentProblem.num1;
            const num2 = currentProblem.num2;
            const sum = num1 + num2;
            
            let explanation = '<h3>Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø­Ù„:</h3>';
            
            if (level === 1 || level === 2) {
                // Ø´Ø±Ø­ Ù„Ù„Ø®Ø§Ù†ØªÙŠÙ† ÙÙ‚Ø·
                const ones1 = num1 % 10;
                const tens1 = Math.floor(num1 / 10) % 10;
                const ones2 = num2 % 10;
                const tens2 = Math.floor(num2 / 10) % 10;
                
                const onesSum = ones1 + ones2;
                const tensSum = tens1 + tens2;
                
                explanation += `
                    <p>1. Ø¬Ù…Ø¹ Ø®Ø§Ù†Ø© Ø§Ù„Ø¢Ø­Ø§Ø¯: ${ones1} + ${ones2} = ${onesSum}</p>
                    <p>2. Ø¬Ù…Ø¹ Ø®Ø§Ù†Ø© Ø§Ù„Ø¹Ø´Ø±Ø§Øª: ${tens1} + ${tens2} = ${tensSum}</p>
                    <p>3. Ø§Ù„Ù†Ø§ØªØ¬ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ: ${tensSum}${onesSum} = ${sum}</p>
                `;
                
                if (onesSum >= 10 && level === 2) {
                    explanation += `
                        <p class="carry-step">Ù…Ù„Ø§Ø­Ø¸Ø©: Ø¹Ù†Ø¯ Ø¬Ù…Ø¹ Ø§Ù„Ø¢Ø­Ø§Ø¯ (${ones1} + ${ones2} = ${onesSum}) 
                        Ù†Ø­ØªÙØ¸ Ø¨Ù€ ${Math.floor(onesSum / 10)} ÙˆÙ†Ø¶ÙŠÙÙ‡ Ø¥Ù„Ù‰ Ø®Ø§Ù†Ø© Ø§Ù„Ø¹Ø´Ø±Ø§Øª</p>
                    `;
                }
            } else {
                // Ø´Ø±Ø­ Ù„Ù„Ø®Ø§Ù†Ø§Øª Ø§Ù„Ø«Ù„Ø§Ø«
                const ones1 = num1 % 10;
                const tens1 = Math.floor(num1 / 10) % 10;
                const hundreds1 = Math.floor(num1 / 100) % 10;
                
                const ones2 = num2 % 10;
                const tens2 = Math.floor(num2 / 10) % 10;
                const hundreds2 = Math.floor(num2 / 100) % 10;
                
                let onesSum = ones1 + ones2;
                let carryOnes = Math.floor(onesSum / 10);
                onesSum = onesSum % 10;
                
                let tensSum = tens1 + tens2 + carryOnes;
                let carryTens = Math.floor(tensSum / 10);
                tensSum = tensSum % 10;
                
                let hundredsSum = hundreds1 + hundreds2 + carryTens;
                
                explanation += `
                    <p>1. Ø¬Ù…Ø¹ Ø®Ø§Ù†Ø© Ø§Ù„Ø¢Ø­Ø§Ø¯: ${ones1} + ${ones2} = ${ones1 + ones2}</p>
                    ${carryOnes > 0 ? `<p>â†’ Ù†Ø­ØªÙØ¸ Ø¨Ù€ ${carryOnes} Ù„Ø®Ø§Ù†Ø© Ø§Ù„Ø¹Ø´Ø±Ø§Øª</p>` : ''}
                    <p>2. Ø¬Ù…Ø¹ Ø®Ø§Ù†Ø© Ø§Ù„Ø¹Ø´Ø±Ø§Øª: ${tens1} + ${tens2} + ${carryOnes} = ${tens1 + tens2 + carryOnes}</p>
                    ${carryTens > 0 ? `<p>â†’ Ù†Ø­ØªÙØ¸ Ø¨Ù€ ${carryTens} Ù„Ø®Ø§Ù†Ø© Ø§Ù„Ù…Ø¦Ø§Øª</p>` : ''}
                    <p>3. Ø¬Ù…Ø¹ Ø®Ø§Ù†Ø© Ø§Ù„Ù…Ø¦Ø§Øª: ${hundreds1} + ${hundreds2} + ${carryTens} = ${hundredsSum}</p>
                    <p>4. Ø§Ù„Ù†Ø§ØªØ¬ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ: ${sum}</p>
                `;
            }
            
            if (!isCorrect) {
                explanation += `<p>Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© Ù‡ÙŠ: ${sum}</p>`;
            }
            
            elements.explanation.innerHTML = explanation;
            elements.explanation.style.display = 'block';
        }
        
        // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©
        function showHelp() {
            alert(`
                ÙƒÙŠÙÙŠØ© Ø­Ù„ Ù…Ø³Ø§Ø¦Ù„ Ø§Ù„Ø¬Ù…Ø¹ Ù…Ø¹ Ø§Ù„Ø§Ø­ØªÙØ§Ø¸:
                
                1. Ø§Ø¨Ø¯Ø£ Ù…Ù† Ø§Ù„ÙŠÙ…ÙŠÙ† (Ø®Ø§Ù†Ø© Ø§Ù„Ø¢Ø­Ø§Ø¯)
                2. Ø§Ø¬Ù…Ø¹ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… ÙÙŠ ÙƒÙ„ Ø®Ø§Ù†Ø©
                3. Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ ÙÙŠ Ø£ÙŠ Ø®Ø§Ù†Ø© Ø£ÙƒØ¨Ø± Ù…Ù† Ø£Ùˆ ÙŠØ³Ø§ÙˆÙŠ 10:
                   - Ø§ÙƒØªØ¨ Ø®Ø§Ù†Ø© Ø§Ù„Ø¢Ø­Ø§Ø¯ Ù…Ù† Ø§Ù„Ù†Ø§ØªØ¬ ÙÙŠ Ø§Ù„Ø£Ø³ÙÙ„
                   - Ø§Ø­ØªÙØ¸ Ø¨Ø®Ø§Ù†Ø© Ø§Ù„Ø¹Ø´Ø±Ø§Øª Ù„ØªØ¶ÙŠÙÙ‡Ø§ Ø¥Ù„Ù‰ Ø§Ù„Ø®Ø§Ù†Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©
                4. Ø§Ù†ØªÙ‚Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ø®Ø§Ù†Ø© Ø§Ù„ØªØ§Ù„ÙŠØ© Ø¹Ù„Ù‰ Ø§Ù„ÙŠØ³Ø§Ø± ÙˆØ£Ø¶Ù Ø£ÙŠ Ø±Ù‚Ù… Ù…Ø­ØªÙØ¸ Ø¨Ù‡
                5. ÙƒØ±Ø± Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø­ØªÙ‰ ØªÙ†ØªÙ‡ÙŠ Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø®Ø§Ù†Ø§Øª
                
                Ø¬Ø±Ø¨ Ù…Ø«Ø§Ù„Ø§Ù‹:
                  Ù¤Ù¥
                + Ù£Ù§
                -----
                  Ù¨Ù¢
                
                Ø§Ù„Ø®Ø·ÙˆØ§Øª:
                1. Ù¥ + Ù§ = Ù¡Ù¢ â†’ Ù†ÙƒØªØ¨ Ù¢ ÙˆÙ†Ø­ØªÙØ¸ Ø¨Ù€ Ù¡
                2. Ù¤ + Ù£ + Ù¡ (Ø§Ù„Ù…Ø­ØªÙØ¸ Ø¨Ù‡) = Ù¨
                3. Ø§Ù„Ù†Ø§ØªØ¬: Ù¨Ù¢
            `);
        }
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ø¬ÙˆÙ… Ø­Ø³Ø¨ Ø§Ù„Ù†Ù‚Ø§Ø·
        function updateStars() {
            const starCount = Math.min(5, Math.floor(score / 3) + 1);
            elements.stars.textContent = 'â˜…'.repeat(starCount) + 'â˜†'.repeat(5 - starCount);
        }
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ø­ØªÙØ§Ø¸ ÙÙŠ Ø§Ù„Ù…Ø³Ø£Ù„Ø©
        function hasCarry(num1, num2) {
            const ones1 = num1 % 10;
            const tens1 = Math.floor(num1 / 10) % 10;
            const ones2 = num2 % 10;
            const tens2 = Math.floor(num2 / 10) % 10;
            
            return (ones1 + ones2 >= 10) || (tens1 + tens2 >= 10);
        }
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ø­ØªÙØ§Ø¸ ÙˆØ§Ø­Ø¯ ÙÙ‚Ø·
        function hasSingleCarry(num1, num2) {
            const ones1 = num1 % 10;
            const tens1 = Math.floor(num1 / 10) % 10;
            const ones2 = num2 % 10;
            const tens2 = Math.floor(num2 / 10) % 10;
            
            const onesCarry = (ones1 + ones2 >= 10);
            const tensCarry = (tens1 + tens2 >= 10);
            
            return (onesCarry && !tensCarry) || (!onesCarry && tensCarry);
        }
        
        // Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©
        window.onload = init;
    </script>
</body>
</html>