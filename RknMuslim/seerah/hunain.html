<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>غزوة حنين | دروس في الثقة بالله</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap');
        
        :root {
            --primary-color: #1A237E;
            --secondary-color: #303F9F;
            --accent-color: #C5CAE9;
            --light-bg: #E8EAF6;
            --dark-text: #0A145A;
            --shadow-color: rgba(26, 35, 126, 0.2);
            --victory-glow: #BBDEFB;
        }
        
        body {
            font-family: 'Tajawal', sans-serif;
            background-color: var(--light-bg);
            margin: 0;
            padding: 0;
            color: var(--dark-text);
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><path d="M30,10 Q50,30 70,10" fill="none" stroke="%23303F9F20" stroke-width="1"/></svg>');
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            padding: 30px 20px;
            border-radius: 0 0 20px 20px;
            box-shadow: 0 4px 15px var(--shadow-color);
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        header::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><text x="10" y="50" font-family="Arial" font-size="30" fill="%23ffffff10">ﷺ</text></svg>') repeat;
            opacity: 0.1;
            pointer-events: none;
        }
        
        h1 {
            font-size: 2.8rem;
            margin: 0;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            position: relative;
        }
        
        .subtitle {
            font-size: 1.3rem;
            margin-top: 10px;
            color: var(--accent-color);
        }
        
        .story-container {
            background-color: white;
            border-radius: 20px;
            padding: 30px;
            margin: 40px 0;
            box-shadow: 0 5px 15px var(--shadow-color);
            border: 2px solid var(--secondary-color);
            position: relative;
            overflow: hidden;
        }
        
        .story-container::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect x="0" y="0" width="100" height="100" fill="none" stroke="%23303F9F" stroke-width="1" stroke-dasharray="5,5" /></svg>');
            opacity: 0.1;
            pointer-events: none;
        }
        
        .story-section {
            margin-bottom: 40px;
            position: relative;
            padding-bottom: 20px;
        }
        
        .story-section::after {
            content: "";
            display: block;
            width: 100px;
            height: 3px;
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            margin: 20px auto 0;
            border-radius: 3px;
        }
        
        .story-section:last-child::after {
            display: none;
        }
        
        .story-title {
            color: var(--primary-color);
            font-size: 1.8rem;
            margin-top: 0;
            text-align: center;
            position: relative;
            display: inline-block;
            left: 50%;
            transform: translateX(-50%);
        }
        
        .story-title::after {
            content: "";
            display: block;
            width: 60%;
            height: 3px;
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            margin: 10px auto 0;
            border-radius: 3px;
        }
        
        .story-content {
            line-height: 1.8;
            font-size: 1.1rem;
            text-align: justify;
        }
        
        .story-image {
            width: 100%;
            max-width: 500px;
            border-radius: 15px;
            margin: 20px auto;
            display: block;
            box-shadow: 0 5px 15px var(--shadow-color);
            border: 3px solid var(--secondary-color);
        }
        
        .victory-story {
            background: linear-gradient(135deg, rgba(187, 222, 251, 0.1) 0%, rgba(48, 63, 159, 0.1) 100%);
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0;
            border-left: 5px solid var(--accent-color);
            position: relative;
            overflow: hidden;
        }
        
        .victory-story::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><text x="10" y="50" font-family="Arial" font-size="20" fill="%23303F9F10">ﷺ</text></svg>');
            opacity: 0.1;
            pointer-events: none;
        }
        
        .victory-title {
            color: var(--primary-color);
            font-size: 1.5rem;
            margin-top: 0;
            position: relative;
        }
        
        .victory-content {
            line-height: 1.8;
            position: relative;
        }
        
        /* ألعاب تفاعلية */
        .game-container {
            background-color: white;
            border-radius: 20px;
            padding: 30px;
            margin: 40px 0;
            box-shadow: 0 5px 15px var(--shadow-color);
            border: 2px solid var(--secondary-color);
        }
        
        .game-title {
            color: var(--primary-color);
            text-align: center;
            font-size: 1.8rem;
            margin-top: 0;
        }
        
        .game-description {
            text-align: center;
            margin-bottom: 30px;
            font-size: 1.1rem;
        }
        
        .game-content {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .battle-timeline {
            width: 100%;
            max-width: 800px;
            position: relative;
            margin: 30px 0;
        }
        
        .timeline-steps {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }
        
        .timeline-step {
            display: flex;
            align-items: flex-start;
            position: relative;
        }
        
        .timeline-marker {
            width: 30px;
            height: 30px;
            background: var(--primary-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-left: 15px;
            flex-shrink: 0;
            position: relative;
            z-index: 2;
        }
        
        .timeline-content {
            background: var(--light-bg);
            border-radius: 10px;
            padding: 15px;
            flex-grow: 1;
            box-shadow: 0 3px 10px var(--shadow-color);
            border: 1px solid var(--accent-color);
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .timeline-content:hover {
            transform: translateX(-10px);
            box-shadow: 0 5px 15px var(--shadow-color);
        }
        
        .timeline-title {
            color: var(--primary-color);
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .timeline-line {
            position: absolute;
            left: 44px;
            top: 30px;
            bottom: 0;
            width: 2px;
            background: var(--secondary-color);
            z-index: 1;
        }
        
        .quiz-question {
            font-size: 1.2rem;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .quiz-options {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
            width: 100%;
            max-width: 500px;
        }
        
        .quiz-option {
            padding: 15px;
            background: var(--light-bg);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            border: 2px solid var(--accent-color);
        }
        
        .quiz-option:hover {
            background: var(--accent-color);
        }
        
        .quiz-option.correct {
            background: #4CAF50;
            color: white;
        }
        
        .quiz-option.wrong {
            background: #F44336;
            color: white;
        }
        
        .game-result {
            text-align: center;
            font-size: 1.3rem;
            margin: 20px 0;
            color: var(--primary-color);
            font-weight: bold;
        }
        
        .restart-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1rem;
            margin-top: 20px;
        }
        
        .restart-btn:hover {
            background: var(--secondary-color);
            transform: translateY(-3px);
        }
        
        footer {
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            border-radius: 20px 20px 0 0;
            margin-top: 40px;
            position: relative;
        }
        
        footer::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><text x="10" y="50" font-family="Arial" font-size="20" fill="%23ffffff10">ﷺ</text></svg>');
            opacity: 0.1;
            pointer-events: none;
        }
        
        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }
            
            .subtitle {
                font-size: 1.1rem;
            }
            
            .timeline-step {
                flex-direction: column;
            }
            
            .timeline-marker {
                margin-left: 0;
                margin-bottom: 10px;
            }
            
            .timeline-line {
                left: 14px;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>غزوة حنين</h1>
            <div class="subtitle">درس في الثقة بالله ونصره</div>
        </div>
    </header>
    
    <div class="container">
        <div class="story-container">
            <div class="story-section">
                <h2 class="story-title">أسباب الغزوة</h2>
                <img src="../../images/seerah/s110.jpg" alt="غزوة حنين" class="story-image">
                <div class="story-content">
                    <p>بعد فتح مكة في السنة الثامنة للهجرة، اجتمعت قبائل هوازن وثقيف لقتال المسلمين، حيث قرروا مهاجمتهم قبل أن يستقر لهم الأمر في مكة. تجمعت القبائل في وادي حنين بقيادة مالك بن عوف النضري.</p>
                    <p>بلغ عدد جيش المشركين حوالي 20 ألف مقاتل، بينما كان جيش المسلمين 12 ألف مقاتل، وكانت هذه أكبر غزوة في عدد المشاركين من المسلمين.</p>
                </div>
                
                <div class="victory-story">
                    <h3 class="victory-title">استعدادات القتال</h3>
                    <div class="victory-content">
                        <p>• تجهيز جيش كبير من المسلمين بعد فتح مكة</p>
                        <p>• تجمع قبائل هوازن وثقيف في وادي حنين</p>
                        <p>• قيادة مالك بن عوف لجيش المشركين</p>
                        <p>• خطة المشركين لمباغتة المسلمين</p>
                    </div>
                </div>
            </div>
            
            <div class="story-section">
                <h2 class="story-title">أحداث المعركة</h2>
                <img src="../../images/seerah/s111.jpg" alt="أحداث المعركة" class="story-image">
                <div class="story-content">
                    <p>عند دخول المسلمين وادي حنين، تعرضوا لكمين من المشركين الذين كانوا متخفين بين الأشجار والصخور. أمطر المشركون المسلمين بوابل من السهام، مما تسبب في ارتباك صفوف المسلمين وفرار بعضهم.</p>
                    <p>ثبت الرسول ﷺ في مكانه مع مجموعة من الصحابة، ونادى: "أنا النبي لا كذب، أنا ابن عبد المطلب". ثم أمر العباس أن ينادي الصحابة، فاجتمع المسلمون من جديد وانتصرت كتلة المؤمنين الصابرة.</p>
                </div>
            </div>
            
            <div class="story-section">
                <h2 class="story-title">دروس مستفادة</h2>
                <img src="../../images/seerah/s18.png" alt="دروس مستفادة" class="story-image">
                <div class="story-content">
                    <p>1. <strong>عدم الغرور بالكثرة</strong>: ﴿وَيَوْمَ حُنَيْنٍ إِذْ أَعْجَبَتْكُمْ كَثْرَتُكُمْ فَلَمْ تُغْنِ عَنكُمْ شَيْئًا﴾</p>
                    <p>2. <strong>الثبات في المواقف الصعبة</strong>: كيف ثبت الرسول ﷺ مع ثلة من الصحابة</p>
                    <p>3. <strong>التوكل على الله</strong>: النصر من عند الله وليس بالعدد والعدة</p>
                    <p>4. <strong>الاعتبار بالتاريخ</strong>: دروس من انتصار المسلمين بعد الهزيمة الأولى</p>
                    <p>5. <strong>الرحمة بعد النصر</strong>: معاملة الرسول ﷺ للأسرى والغنائم</p>
                </div>
            </div>
        </div>
        
        <!-- الخط الزمني للمعركة -->
        <div class="game-container" id="timeline-game-container">
            <h2 class="game-title">مراحل غزوة حنين</h2>
            <p class="game-description">تعرف على أحداث المعركة خطوة بخطوة</p>
            <div class="game-content">
                <div class="battle-timeline">
                    <div class="timeline-steps">
                        <div class="timeline-step">
                            <div class="timeline-marker">1</div>
                            <div class="timeline-content" onclick="showBattleDetail(0)">
                                <div class="timeline-title">خروج المسلمين إلى حنين</div>
                                <p>خرج الرسول ﷺ بجيش المسلمين إلى وادي حنين بعد فتح مكة</p>
                            </div>
                            <div class="timeline-line"></div>
                        </div>
                        
                        <div class="timeline-step">
                            <div class="timeline-marker">2</div>
                            <div class="timeline-content" onclick="showBattleDetail(1)">
                                <div class="timeline-title">كمين هوازن</div>
                                <p>نصب المشركون كمينًا للمسلمين في مضيق الوادي</p>
                            </div>
                        </div>
                        
                        <div class="timeline-step">
                            <div class="timeline-marker">3</div>
                            <div class="timeline-content" onclick="showBattleDetail(2)">
                                <div class="timeline-title">ارتباك المسلمين</div>
                                <p>فرار بعض المسلمين بعد هجوم المشركين المفاجئ</p>
                            </div>
                        </div>
                        
                        <div class="timeline-step">
                            <div class="timeline-marker">4</div>
                            <div class="timeline-content" onclick="showBattleDetail(3)">
                                <div class="timeline-title">ثبات الرسول ﷺ</div>
                                <p>ثبت النبي مع مجموعة من الصحابة ونادى بأعلى صوته</p>
                            </div>
                        </div>
                        
                        <div class="timeline-step">
                            <div class="timeline-marker">5</div>
                            <div class="timeline-content" onclick="showBattleDetail(4)">
                                <div class="timeline-title">اجتماع الصفوف</div>
                                <p>تجمع المسلمون من جديد بعد نداء العباس</p>
                            </div>
                        </div>
                        
                        <div class="timeline-step">
                            <div class="timeline-marker">6</div>
                            <div class="timeline-content" onclick="showBattleDetail(5)">
                                <div class="timeline-title">انتصار المسلمين</div>
                                <p>تحولت الهزيمة إلى نصر مؤزر للمسلمين</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- اختبار المعلومات -->
        <div class="game-container" id="quiz-game-container">
            <h2 class="game-title">اختبار المعلومات</h2>
            <p class="game-description">اختر الإجابة الصحيحة لكل سؤال حول غزوة حنين</p>
            <div class="game-content">
                <div class="quiz-question" id="quiz-question">ما هي القبيلة التي قادت جيش المشركين في حنين؟</div>
                <div class="quiz-options" id="quiz-options">
                    <!-- سيتم إضافة الخيارات هنا بالجافاسكريبت -->
                </div>
                <div class="game-result" id="quiz-result"></div>
                <button class="restart-btn" onclick="nextQuizQuestion()">السؤال التالي</button>
            </div>
        </div>
        
        <!-- لعبة ترتيب الأحداث -->
        <div class="game-container" id="sort-game-container">
            <h2 class="game-title">ترتيب الأحداث</h2>
            <p class="game-description">اسحب الأحداث وأسقطها بالترتيب الصحيح</p>
            <div class="game-content">
                <div id="sortable-list" style="width: 100%;">
                    <div class="sortable-item" draggable="true" data-order="1">خروج المسلمين إلى حنين</div>
                    <div class="sortable-item" draggable="true" data-order="2">كمين هوازن المفاجئ</div>
                    <div class="sortable-item" draggable="true" data-order="3">فرار بعض المسلمين</div>
                    <div class="sortable-item" draggable="true" data-order="4">ثبات الرسول ﷺ</div>
                    <div class="sortable-item" draggable="true" data-order="5">اجتماع الصفوف من جديد</div>
                    <div class="sortable-item" draggable="true" data-order="6">انتصار المسلمين</div>
                </div>
                <div class="game-result" id="sort-result"></div>
                <button class="restart-btn" onclick="resetSortGame()">إعادة المحاولة</button>
            </div>
        </div>
</div>
    
    <!-- رسالة منبثقة لتفاصيل المعركة -->
    <div id="battle-modal" class="modal-overlay">
        <div class="modal-content">
  
<div class="modal-body" id="battle-modal-body">
    <!-- سيتم ملؤها بالجافاسكريبت -->
  </div>
            <div class="modal-footer">
              
    
    <!-- رسالة منبثقة للغنائم -->
    <div id="spoils-modal" class="modal-overlay">
        <div class="modal-content">
<div class="modal-header">
               
         
</div>
    
    <footer>
        <div class="container">
            <p>© 2023 غزوة حنين | تصميم تعليمي تفاعلي</p>
        </div>
    </footer>
    
    <script>
        // تفاصيل مراحل المعركة
        const battleDetails = [
            {
                title: "خروج المسلمين إلى حنين",
                content: `
                    <p>بعد فتح مكة، قرر الرسول ﷺ التوجه إلى حنين لمواجهة قبائل هوازن وثقيف الذين تجمعوا لقتال المسلمين. كان جيش المسلمين كبيرًا (12 ألف مقاتل) بسبب انضمام العديد من القبائل بعد فتح مكة.</p>
                    <p>قال الله تعالى: <span style="color: var(--primary-color);">﴿لَقَدْ نَصَرَكُمُ اللَّهُ فِي مَوَاطِنَ كَثِيرَةٍ وَيَوْمَ حُنَيْنٍ إِذْ أَعْجَبَتْكُمْ كَثْرَتُكُمْ فَلَمْ تُغْنِ عَنكُمْ شَيْئًا﴾</span> [التوبة:25]</p>
                    <img src="https://i.imgur.com/battle1.jpg" alt="خروج المسلمين" style="width: 100%; border-radius: 10px; margin: 15px 0; border: 2px solid var(--secondary-color);">
                `
            },
            {
                title: "كمين هوازن",
                content: `
                    <p>نصب جيش هوازن بقيادة مالك بن عوف كمينًا للمسلمين في مضيق وادي حنين. اختبأ المشركون بين الأشجار والصخور، ثم أمطروا المسلمين بوابل من السهام عند دخولهم الوادي.</p>
                    <p>كانت هذه الخطة مفاجئة للمسلمين، حيث لم يتوقعوا هذا الكمين بعد انتصارهم الكبير في فتح مكة.</p>
                    <img src="https://i.imgur.com/battle2.jpg" alt="كمين هوازن" style="width: 100%; border-radius: 10px; margin: 15px 0; border: 2px solid var(--secondary-color);">
                `
            },
            {
                title: "ارتباك المسلمين",
                content: `
                    <p>بسبب الهجوم المفاجئ، ارتبكت صفوف المسلمين وفر بعضهم. قال الله تعالى: <span style="color: var(--primary-color);">﴿ثُمَّ وَلَّيْتُم مُّدْبِرِينَ﴾</span> [التوبة:25].</p>
                    <p>كانت هذه اللحظة من أصعب لحظات المعركة، حيث بدا أن المسلمين على وشك الهزيمة رغم كثرتهم.</p>
                    <img src="https://i.imgur.com/battle3.jpg" alt="ارتباك المسلمين" style="width: 100%; border-radius: 10px; margin: 15px 0; border: 2px solid var(--secondary-color);">
                `
            },
            {
                title: "ثبات الرسول ﷺ",
                content: `
                    <p>ثبت الرسول ﷺ في مكانه مع ثلة من المؤمنين، ونادى بأعلى صوته: "أنا النبي لا كذب، أنا ابن عبد المطلب". كان هذا النداء بمثابة شحنة إيمانية للمسلمين.</p>
                    <p>كان مع الرسول ﷺ في هذه اللحظات الصعبة أبو بكر وعمر وعلي والعباس وغيرهم من كبار الصحابة.</p>
                    <img src="https://i.imgur.com/battle4.jpg" alt="ثبات الرسول" style="width: 100%; border-radius: 10px; margin: 15px 0; border: 2px solid var(--secondary-color);">
                `
            },
            {
                title: "اجتماع الصفوف",
                content: `
                    <p>أمر الرسول ﷺ العباس بن عبد المطلب - وكان جهوري الصوت - أن ينادي الصحابة: "يا معشر الأنصار، يا أصحاب الشجرة". فتجمع المسلمون مرة أخرى حول رسول الله.</p>
                    <p>بدأ المسلمون يعودون إلى مواقعهم، وتجمعت صفوفهم من جديد لمواجهة العدو.</p>
                    <img src="https://i.imgur.com/battle5.jpg" alt="اجتماع الصفوف" style="width: 100%; border-radius: 10px; margin: 15px 0; border: 2px solid var(--secondary-color);">
                `
            },
            {
                title: "انتصار المسلمين",
                content: `
                    <p>بعد تجمع الصفوف، تحولت الهزيمة إلى نصر كبير. هزم المسلمون جيش المشركين، وغنموا غنائم كثيرة. قال الله تعالى: <span style="color: var(--primary-color);">﴿ثُمَّ أَنزَلَ اللَّهُ سَكِينَتَهُ عَلَىٰ رَسُولِهِ وَعَلَى الْمُؤْمِنِينَ وَأَنزَلَ جُنُودًا لَّمْ تَرَوْهَا﴾</span> [التوبة:26]</p>
                    <p>كانت هذه الغزوة درسًا للمسلمين في عدم الغرور بالكثرة والاعتماد على الله تعالى.</p>
                    <button class="modal-btn" style="margin-top: 15px;" onclick="showModal('spoils-modal')">اقرأ عن غنائم حنين</button>
                    <img src="https://i.imgur.com/battle6.jpg" alt="انتصار المسلمين" style="width: 100%; border-radius: 10px; margin: 15px 0; border: 2px solid var(--secondary-color);">
                `
            }
        ];
        
        function showBattleDetail(index) {
            const detail = battleDetails[index];
            document.getElementById('battle-modal-title').textContent = detail.title;
            document.getElementById('battle-modal-body').innerHTML = detail.content;
            showModal('battle-modal');
        }
        
        // اختبار المعلومات
        const quizQuestions = [
            {
                question: "ما هي القبيلة التي قادت جيش المشركين في حنين؟",
                options: ["قريش", "هوازن", "ثقيف", "بني قينقاع"],
                answer: 1
            },
            {
                question: "كم كان عدد جيش المسلمين في حنين؟",
                options: ["3 آلاف", "10 آلاف", "12 ألف", "15 ألف"],
                answer: 2
            },
            {
                question: "من الذي نادى بالصحابة ليعودوا إلى القتال؟",
                options: ["عمر بن الخطاب", "العباس بن عبد المطلب", "علي بن أبي طالب", "بلال بن رباح"],
                answer: 1
            },
            {
                question: "ما هي الآية التي نزلت في غزوة حنين؟",
                options: ["﴿إِذَا جَاءَ نَصْرُ اللَّهِ وَالْفَتْحُ﴾", "﴿وَأَنزَلَ جُنُودًا لَّمْ تَرَوْهَا﴾", "﴿إِنَّا فَتَحْنَا لَكَ فَتْحًا مُّبِينًا﴾", "﴿إِنَّا أَعْطَيْنَاكَ الْكَوْثَرَ﴾"],
                answer: 1
            },
            {
                question: "ما هو الدرس الرئيسي من غزوة حنين؟",
                options: ["أهمية التخطيط العسكري", "عدم الغرور بالكثرة", "ضرورة قتال الكفار", "فضل الجهاد في سبيل الله"],
                answer: 1
            }
        ];
        
        let currentQuizQuestion = 0;
        let quizScore = 0;
        
        function setupQuizQuestion() {
            if (currentQuizQuestion >= quizQuestions.length) {
                document.getElementById('quiz-question').textContent = 'انتهى الاختبار!';
                document.getElementById('quiz-options').innerHTML = '';
                document.getElementById('quiz-result').textContent = `نقاطك: ${quizScore} من ${quizQuestions.length}`;
                return;
            }
            
            const question = quizQuestions[currentQuizQuestion];
            document.getElementById('quiz-question').textContent = question.question;
            
            const quizOptions = document.getElementById('quiz-options');
            quizOptions.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'quiz-option';
                optionElement.textContent = option;
                optionElement.addEventListener('click', () => checkQuizAnswer(index));
                quizOptions.appendChild(optionElement);
            });
            
            document.getElementById('quiz-result').textContent = '';
        }
        
        function checkQuizAnswer(selectedIndex) {
            const question = quizQuestions[currentQuizQuestion];
            const options = document.querySelectorAll('.quiz-option');
            
            options.forEach((option, index) => {
                if (index === question.answer) {
                    option.classList.add('correct');
                } else if (index === selectedIndex && index !== question.answer) {
                    option.classList.add('wrong');
                }
                
                option.style.pointerEvents = 'none';
            });
            
            if (selectedIndex === question.answer) {
                quizScore++;
                document.getElementById('quiz-result').textContent = 'إجابة صحيحة!';
            } else {
                document.getElementById('quiz-result').textContent = 'إجابة خاطئة! الجواب الصحيح: ' + question.options[question.answer];
            }
        }
        
        function nextQuizQuestion() {
            currentQuizQuestion++;
            setupQuizQuestion();
        }
        
        // لعبة ترتيب الأحداث
        function setupSortGame() {
            const items = document.querySelectorAll('.sortable-item');
            items.forEach(item => {
                item.addEventListener('dragstart', dragStart);
                item.style.order = Math.floor(Math.random() * 100);
            });
            
            document.getElementById('sortable-list').addEventListener('dragover', dragOver);
            document.getElementById('sortable-list').addEventListener('drop', drop);
        }
        
        function dragStart(e) {
            e.dataTransfer.setData('text/plain', this.dataset.order);
            this.classList.add('dragging');
        }
        
        function dragOver(e) {
            e.preventDefault();
        }
        
        function drop(e) {
            e.preventDefault();
            const draggedOrder = e.dataTransfer.getData('text/plain');
            const draggedItem = document.querySelector(`.sortable-item[data-order="${draggedOrder}"]`);
            const afterElement = getDragAfterElement(this, e.clientY);
            
            if (afterElement) {
                this.insertBefore(draggedItem, afterElement);
            } else {
                this.appendChild(draggedItem);
            }
            
            checkSortOrder();
        }
        
        function getDragAfterElement(container, y) {
            const draggableElements = [...container.querySelectorAll('.sortable-item:not(.dragging)')];
            
            return draggableElements.reduce((closest, child) => {
                const box = child.getBoundingClientRect();
                const offset = y - box.top - box.height / 2;
                
                if (offset < 0 && offset > closest.offset) {
                    return { offset: offset, element: child };
                } else {
                    return closest;
                }
            }, { offset: Number.NEGATIVE_INFINITY }).element;
        }
        
        function checkSortOrder() {
            const items = document.querySelectorAll('.sortable-item');
            let correct = true;
            
            items.forEach((item, index) => {
                if (parseInt(item.dataset.order) !== index + 1) {
                    correct = false;
                }
            });
            
            if (correct) {
                document.getElementById('sort-result').textContent = 'أحسنت! الترتيب صحيح';
                document.getElementById('sort-result').style.color = '#4CAF50';
            } else {
                document.getElementById('sort-result').textContent = '';
            }
        }
        
        function resetSortGame() {
            const items = document.querySelectorAll('.sortable-item');
            items.forEach(item => {
                item.style.order = Math.floor(Math.random() * 100);
            });
            document.getElementById('sort-result').textContent = '';
        }
        
        // وظائف إدارة الرسائل المنبثقة
        function showModal(modalId, title, content) {
            const modal = document.getElementById(modalId);
            if (title) modal.querySelector('.modal-header h2').textContent = title;
            if (content) modal.querySelector('.modal-body').innerHTML = content;
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }
        
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
            document.body.style.overflow = 'auto';
        }
        
        // إغلاق النافذة المنبثقة عند النقر خارجها
        document.querySelectorAll('.modal-overlay').forEach(modal => {
            modal.addEventListener('click', function(e) {
                if (e.target === this) {
                    closeModal(this.id);
                }
            });
        });
        
        // تهيئة الصفحة عند التحميل
        window.addEventListener('load', function() {
            setupQuizQuestion();
            setupSortGame();
        });
    </script>
</body>
</html>