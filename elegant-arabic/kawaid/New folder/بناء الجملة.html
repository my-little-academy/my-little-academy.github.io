<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„Ø¹Ø¨Ø© Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø¬Ù…Ù„Ø© Ø§Ù„Ù†Ø±Ø¯ÙŠØ©</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@700&family=Amiri:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #4CAF50; /* Green */
            --secondary-color: #FFC107; /* Amber */
            --light-bg: #e8f5e9; /* Light green */
            --dark-text: #2c3e50;
            --word-bg: #8bc34a; /* Lighter green */
            --selected-word-bg: #689f38; /* Darker green */
            --drop-zone-Ø§Ø³Ù…ÙŠØ©: #2196F3; /* Blue */
            --drop-zone-ÙØ¹Ù„ÙŠØ©: #F44336; /* Red */
        }

        body {
            font-family: 'Amiri', serif;
            background: linear-gradient(to bottom right, var(--light-bg), #dcedc8);
            color: var(--dark-text);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            direction: rtl;
            text-align: right;
            overflow: auto; /* Allow scrolling if content is tall */
        }

        .game-container {
            background-color: #fff;
            border-radius: 20px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
            padding: 40px;
            width: 90%;
            max-width: 900px;
            text-align: center;
        }

        h1 {
            font-family: 'Cairo', sans-serif;
            color: var(--primary-color);
            margin-bottom: 25px;
            font-size: 2.8em;
        }

        .how-to-play {
            background-color: #f0fff0; /* Lighter green background for instructions */
            border: 1px solid #c8e6c9;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 25px;
            text-align: right;
        }

        .how-to-play h3 {
            font-family: 'Cairo', sans-serif;
            color: var(--primary-color);
            margin-top: 0;
            font-size: 1.5em;
            text-align: center;
        }

        .how-to-play ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .how-to-play li {
            margin-bottom: 8px;
            font-size: 1.1em;
            position: relative;
            padding-right: 25px;
        }

        .how-to-play li::before {
            content: 'ğŸ‘‡'; /* Down arrow emoji */
            position: absolute;
            right: 0;
            font-size: 0.9em;
            top: 50%;
            transform: translateY(-50%);
        }

        p {
            font-size: 1.1em;
            line-height: 1.7;
            margin-bottom: 20px;
        }

        .dice-area {
            background-color: var(--secondary-color);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.2);
        }

        .dice-words-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            min-height: 80px; /* Space for words */
        }

        .word-dice {
            background-color: var(--word-bg);
            color: white;
            padding: 12px 20px;
            border-radius: 10px;
            font-size: 1.5em;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            transition: transform 0.1s ease, background-color 0.2s ease;
        }

        .word-dice:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }

        .word-dice.selected {
            background-color: var(--selected-word-bg);
            border: 2px solid #33691e; /* Darker border */
            transform: scale(1.05);
        }

        .sentence-preview {
            background-color: #f0f0f0;
            border: 2px dashed #ccc;
            border-radius: 10px;
            padding: 20px;
            min-height: 70px;
            font-size: 1.8em;
            font-weight: bold;
            color: var(--dark-text);
            margin-bottom: 25px;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }
        .sentence-preview span {
            background-color: #ddd;
            padding: 5px 10px;
            border-radius: 5px;
        }


        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 25px;
        }

        .action-button {
            font-family: 'Cairo', sans-serif;
            padding: 12px 25px;
            font-size: 1.2em;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: background-color 0.2s ease, transform 0.1s ease;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .action-button.roll-dice {
            background-color: var(--primary-color);
            color: white;
        }
        .action-button.roll-dice:hover {
            background-color: #43a047;
            transform: translateY(-2px);
        }

        .action-button.reset {
            background-color: #9e9e9e; /* Grey */
            color: white;
        }
        .action-button.reset:hover {
            background-color: #757575;
            transform: translateY(-2px);
        }

        .type-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 25px;
        }

        .type-button {
            font-family: 'Cairo', sans-serif;
            padding: 15px 30px;
            font-size: 1.5em;
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .type-button.Ø§Ø³Ù…ÙŠØ© {
            background-color: var(--drop-zone-Ø§Ø³Ù…ÙŠØ©);
        }
        .type-button.Ø§Ø³Ù…ÙŠØ©:hover {
            background-color: #1976D2;
            transform: translateY(-3px);
        }

        .type-button.ÙØ¹Ù„ÙŠØ© {
            background-color: var(--drop-zone-ÙØ¹Ù„ÙŠØ©);
        }
        .type-button.ÙØ¹Ù„ÙŠØ©:hover {
            background-color: #D32F2F;
            transform: translateY(-3px);
        }

        .feedback-message {
            margin-top: 20px;
            font-size: 1.4em;
            font-weight: bold;
            min-height: 1.8em;
        }
        .feedback-message.correct { color: var(--primary-color); }
        .feedback-message.incorrect { color: var(--red-error); }
    </style>
</head>
<body>

    <div class="game-container">
        <h1>ğŸ² Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø¬Ù…Ù„Ø© Ø§Ù„Ù†Ø±Ø¯ÙŠØ©: ÙƒÙˆÙ‘Ù† ÙˆØµÙ†Ù‘Ù! ğŸ²</h1>

        <div class="how-to-play">
            <h3>ÙƒÙŠÙ ØªÙ„Ø¹Ø¨ØŸ</h3>
            <ul>
                <li>**Ø±Ù…ÙŠ Ø§Ù„Ù†Ø±Ø¯:** Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± "Ø±Ù…ÙŠ Ø§Ù„Ù†Ø±Ø¯" Ù„ØªØ­ØµÙ„ Ø¹Ù„Ù‰ ÙƒÙ„Ù…Ø§Øª Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©.</li>
                <li>**ÙƒÙˆÙ‘Ù† Ø¬Ù…Ù„Ø©:** Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ØªÙˆÙØ±Ø© (Ø§Ù„Ù†Ø±Ø¯) Ø¨Ø§Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„ØµØ­ÙŠØ­ Ù„ØªÙƒÙˆÙŠÙ† Ø¬Ù…Ù„Ø© Ù…ÙÙŠØ¯Ø©. Ø³ØªØ¸Ù‡Ø± Ø§Ù„Ø¬Ù…Ù„Ø© ÙÙŠ Ù…Ù†Ø·Ù‚Ø© "Ø¬Ù…Ù„ØªÙƒ Ø§Ù„Ù…ÙƒÙˆÙ†Ø©".</li>
                <li>**Ø­Ø¯Ø¯ Ø§Ù„Ù†ÙˆØ¹:** Ø¨Ø¹Ø¯ ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø¬Ù…Ù„Ø©ØŒ Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± "Ù‡Ø°Ù‡ Ø¬Ù…Ù„Ø© Ø§Ø³Ù…ÙŠØ©" Ø¥Ø°Ø§ ÙƒØ§Ù†Øª ØªØ¨Ø¯Ø£ Ø¨Ù€**Ø§Ø³Ù…**ØŒ Ø£Ùˆ "Ù‡Ø°Ù‡ Ø¬Ù…Ù„Ø© ÙØ¹Ù„ÙŠØ©" Ø¥Ø°Ø§ ÙƒØ§Ù†Øª ØªØ¨Ø¯Ø£ Ø¨Ù€**ÙØ¹Ù„**.</li>
                <li>**Ø¬ÙˆÙ„Ø© Ø¬Ø¯ÙŠØ¯Ø©:** Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± "Ø¬ÙˆÙ„Ø© Ø¬Ø¯ÙŠØ¯Ø©" Ù„ØªØ¨Ø¯Ø£ ØªØ­Ø¯ÙŠØ§Ù‹ Ø¢Ø®Ø±.</li>
            </ul>
        </div>

        <div class="dice-area">
            <h3>Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ØªÙˆÙØ±Ø©:</h3>
            <div id="diceWordsContainer" class="dice-words-container">
                </div>
            <div class="action-buttons">
                <button id="rollDiceButton" class="action-button roll-dice">Ø±Ù…ÙŠ Ø§Ù„Ù†Ø±Ø¯ ğŸ”„</button>
            </div>
        </div>

        <h3>Ø¬Ù…Ù„ØªÙƒ Ø§Ù„Ù…ÙƒÙˆÙ†Ø©:</h3>
        <div id="sentencePreview" class="sentence-preview">
            <span style="color: #666; font-size: 0.8em;">Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø¨Ø§Ù„ØªØ±ØªÙŠØ¨ Ù„ØªÙƒÙˆÙŠÙ† Ø¬Ù…Ù„Ø©</span>
        </div>

        <div class="type-buttons">
            <button id="checkAsIsmiya" class="type-button Ø§Ø³Ù…ÙŠØ©">Ù‡Ø°Ù‡ Ø¬Ù…Ù„Ø© Ø§Ø³Ù…ÙŠØ© âœ”ï¸</button>
            <button id="checkAsFealiya" class="type-button ÙØ¹Ù„ÙŠØ©">Ù‡Ø°Ù‡ Ø¬Ù…Ù„Ø© ÙØ¹Ù„ÙŠØ© âœ”ï¸</button>
        </div>

        <p id="feedback" class="feedback-message"></p>
        <button class="action-button roll-dice" id="nextRoundButton" style="display: none; margin-top: 20px;">Ø¬ÙˆÙ„Ø© Ø¬Ø¯ÙŠØ¯Ø©</button>
    </div>

    <script>
        const allWords = [
            { text: "Ø§Ù„ÙˆÙ„Ø¯", type: "Ø§Ø³Ù…" },
            { text: "Ø§Ù„Ù‚Ø·Ø©", type: "Ø§Ø³Ù…" },
            { text: "Ø§Ù„Ø´Ù…Ø³", type: "Ø§Ø³Ù…" },
            { text: "Ø§Ù„Ø­Ø¯ÙŠÙ‚Ø©", type: "Ø§Ø³Ù…" },
            { text: "Ø§Ù„Ù…Ø¹Ù„Ù…", type: "Ø§Ø³Ù…" },
            { text: "Ø§Ù„Ø·Ø§Ù„Ø¨", type: "Ø§Ø³Ù…" },
            { text: "ÙŠÙ„Ø¹Ø¨", type: "ÙØ¹Ù„" },
            { text: "ØªÙ†Ø§Ù…", type: "ÙØ¹Ù„" },
            { text: "ØªØ´Ø±Ù‚", type: "ÙØ¹Ù„" },
            { text: "ÙŠØ²Ø±Ø¹", type: "ÙØ¹Ù„" },
            { text: "ÙŠØ´Ø±Ø­", type: "ÙØ¹Ù„" },
            { text: "ÙŠÙ‚Ø±Ø£", type: "ÙØ¹Ù„" },
            { text: "ÙÙŠ", type: "Ø­Ø±Ù" },
            { text: "Ø¹Ù„Ù‰", type: "Ø­Ø±Ù" },
            { text: "Ù…Ù†", type: "Ø­Ø±Ù" },
            { text: "Ø¥Ù„Ù‰", type: "Ø­Ø±Ù" },
            { text: "Ùˆ", type: "Ø­Ø±Ù" }, // Ø­Ø±Ù Ø¹Ø·Ù
            { text: "Ø«Ù…", type: "Ø­Ø±Ù" } // Ø­Ø±Ù Ø¹Ø·Ù
        ];

        let availableDiceWords = [];
        let selectedSentenceWords = []; // Array of {text: "ÙƒÙ„Ù…Ø©", type: "Ø§Ø³Ù…"}

        // DOM Elements
        const diceWordsContainer = document.getElementById('diceWordsContainer');
        const sentencePreview = document.getElementById('sentencePreview');
        const rollDiceButton = document.getElementById('rollDiceButton');
        const checkAsIsmiyaButton = document.getElementById('checkAsIsmiya');
        const checkAsFealiyaButton = document.getElementById('checkAsFealiya');
        const feedbackDiv = document.getElementById('feedback');
        const nextRoundButton = document.getElementById('nextRoundButton');

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function renderDiceWords() {
            diceWordsContainer.innerHTML = '';
            shuffleArray(allWords); // Shuffle all words
            availableDiceWords = allWords.slice(0, 6); // Take 6 random words for this round

            availableDiceWords.forEach((wordData, index) => {
                const div = document.createElement('div');
                div.classList.add('word-dice');
                div.textContent = wordData.text;
                div.setAttribute('data-word-text', wordData.text);
                div.setAttribute('data-word-type', wordData.type);
                div.setAttribute('data-index', index); // To help identify original word
                div.addEventListener('click', selectWordForSentence);
                diceWordsContainer.appendChild(div);
            });
            updateSentencePreview();
        }

        function selectWordForSentence(event) {
            const clickedWordDiv = event.target;
            const wordText = clickedWordDiv.dataset.wordText;
            const wordType = clickedWordDiv.dataset.word-type;
            const originalIndex = clickedWordDiv.dataset.index;

            // Prevent selecting a word twice for the same sentence
            if (clickedWordDiv.classList.contains('selected')) {
                // If already selected, remove it from the sentence
                selectedSentenceWords = selectedSentenceWords.filter(word => !(word.text === wordText && word.originalIndex === originalIndex));
                clickedWordDiv.classList.remove('selected');
            } else {
                // Add to sentence
                selectedSentenceWords.push({ text: wordText, type: wordType, originalIndex: originalIndex });
                clickedWordDiv.classList.add('selected');
            }
            updateSentencePreview();
            feedbackDiv.innerText = ''; // Clear feedback on interaction
        }

        function updateSentencePreview() {
            sentencePreview.innerHTML = '';
            if (selectedSentenceWords.length === 0) {
                sentencePreview.innerHTML = '<span style="color: #666; font-size: 0.8em;">Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø¨Ø§Ù„ØªØ±ØªÙŠØ¨ Ù„ØªÙƒÙˆÙŠÙ† Ø¬Ù…Ù„Ø©</span>';
            } else {
                selectedSentenceWords.forEach(word => {
                    const span = document.createElement('span');
                    span.textContent = word.text;
                    sentencePreview.appendChild(span);
                });
            }
        }

        function checkSentenceType(assumedType) {
            if (selectedSentenceWords.length === 0) {
                showFeedback("Ø§Ø®ØªØ± ÙƒÙ„Ù…Ø§Øª Ù„ØªÙƒÙˆÙŠÙ† Ø¬Ù…Ù„Ø© Ø£ÙˆÙ„Ø§Ù‹!", false);
                return;
            }

            const firstWordType = selectedSentenceWords[0].type;
            let isCorrect = false;
            let expectedType = '';

            if (firstWordType === "Ø§Ø³Ù…") {
                expectedType = "Ø§Ø³Ù…ÙŠØ©";
            } else if (firstWordType === "ÙØ¹Ù„") {
                expectedType = "ÙØ¹Ù„ÙŠØ©";
            } else {
                // If it starts with a particle, it's generally not a complete sentence in this context,
                // or it leads to a complex structure we're not teaching yet.
                // For simplicity, we'll mark it incorrect.
                expectedType = "Ø§Ø³Ù…ÙŠØ© Ø£Ùˆ ÙØ¹Ù„ÙŠØ© (Ù„ÙŠØ³Øª Ø­Ø±ÙØ§Ù‹)";
            }
            
            isCorrect = (assumedType === expectedType && (firstWordType === "Ø§Ø³Ù…" || firstWordType === "ÙØ¹Ù„"));

            if (isCorrect) {
                showFeedback(`Ù…Ù…ØªØ§Ø²! Ù‡Ø°Ù‡ Ø¬Ù…Ù„Ø© ${expectedType} Ù„Ø£Ù†Ù‡Ø§ ØªØ¨Ø¯Ø£ Ø¨Ù€ "${selectedSentenceWords[0].text}" ÙˆÙ‡Ùˆ ${firstWordType}. ğŸ‰`, true);
                nextRoundButton.style.display = 'block';
                checkAsIsmiyaButton.disabled = true;
                checkAsFealiyaButton.disabled = true;
                rollDiceButton.disabled = true;
                // Make selected words non-clickable
                document.querySelectorAll('.word-dice.selected').forEach(wordDiv => {
                    wordDiv.removeEventListener('click', selectWordForSentence);
                    wordDiv.style.cursor = 'default';
                });
            } else {
                let errorMessage = `Ø®Ø·Ø£! Ù‡Ø°Ù‡ Ø§Ù„Ø¬Ù…Ù„Ø© ØªØ¨Ø¯Ø£ Ø¨Ù€ "${selectedSentenceWords[0].text}" ÙˆÙ‡Ùˆ ${firstWordType}. `;
                if (firstWordType === "Ø§Ø³Ù…") {
                    errorMessage += `ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø¬Ù…Ù„Ø© Ø§Ø³Ù…ÙŠØ©.`;
                } else if (firstWordType === "ÙØ¹Ù„") {
                    errorMessage += `ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø¬Ù…Ù„Ø© ÙØ¹Ù„ÙŠØ©.`;
                } else { // Ø­Ø±Ù
                    errorMessage += `Ø§Ù„Ø¬Ù…Ù„Ø© Ù„Ø§ ØªØ¨Ø¯Ø£ Ø¨Ø­Ø±Ù!`;
                }
                showFeedback(errorMessage, false);
            }
        }

        function showFeedback(message, isCorrect) {
            feedbackDiv.innerText = message;
            feedbackDiv.classList.remove('correct', 'incorrect');
            if (isCorrect) {
                feedbackDiv.classList.add('correct');
            } else {
                feedbackDiv.classList.add('incorrect');
            }
        }

        function startNewRound() {
            selectedSentenceWords = [];
            renderDiceWords();
            feedbackDiv.innerText = '';
            nextRoundButton.style.display = 'none';
            checkAsIsmiyaButton.disabled = false;
            checkAsFealiyaButton.disabled = false;
            rollDiceButton.disabled = false;
            // Re-add click listeners to all new dice words
            document.querySelectorAll('.word-dice').forEach(wordDiv => {
                wordDiv.addEventListener('click', selectWordForSentence);
                wordDiv.style.cursor = 'pointer';
                wordDiv.classList.remove('selected'); // Unselect any previously selected
            });
        }

        // Event Listeners
        rollDiceButton.addEventListener('click', startNewRound); // Roll dice acts as start new round
        checkAsIsmiyaButton.addEventListener('click', () => checkSentenceType('Ø§Ø³Ù…ÙŠØ©'));
        checkAsFealiyaButton.addEventListener('click', () => checkSentenceType('ÙØ¹Ù„ÙŠØ©'));
        nextRoundButton.addEventListener('click', startNewRound);

        // Initial render
        startNewRound();
    </script>
</body>
</html>