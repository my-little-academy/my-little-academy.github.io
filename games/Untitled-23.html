<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø­Ø§ÙƒØ§Ø© Ù…Ù†Ø§Ø³Ùƒ Ø§Ù„Ø­Ø¬ Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            min-height: 100vh;
            direction: rtl;
        }

        .game-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            color: #f39c12;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #27ae60, #2ecc71);
            width: 0%;
            transition: width 0.5s ease;
        }

        .game-board {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .ritual-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
            border: 2px solid transparent;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .ritual-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .ritual-card.completed {
            border-color: #27ae60;
            background: rgba(39, 174, 96, 0.2);
        }

        .ritual-card.current {
            border-color: #f39c12;
            background: rgba(243, 156, 18, 0.2);
            animation: pulse 2s infinite;
        }

        .ritual-card.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(243, 156, 18, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(243, 156, 18, 0); }
            100% { box-shadow: 0 0 0 0 rgba(243, 156, 18, 0); }
        }

        .ritual-number {
            position: absolute;
            top: -10px;
            right: -10px;
            width: 40px;
            height: 40px;
            background: #f39c12;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2em;
        }

        .ritual-title {
            font-size: 1.5em;
            margin-bottom: 10px;
            color: #f39c12;
        }

        .ritual-description {
            font-size: 1em;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .ritual-status {
            font-size: 0.9em;
            padding: 5px 10px;
            border-radius: 20px;
            display: inline-block;
            margin-top: 10px;
        }

        .status-completed {
            background: #27ae60;
            color: white;
        }

        .status-current {
            background: #f39c12;
            color: white;
        }

        .status-locked {
            background: #7f8c8d;
            color: white;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
        }

        .modal-content {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            margin: 2% auto;
            padding: 30px;
            border-radius: 20px;
            width: 95%;
            max-width: 800px;
            position: relative;
            animation: modalSlide 0.3s ease;
            max-height: 95vh;
            overflow-y: auto;
        }

        @keyframes modalSlide {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .close {
            position: absolute;
            top: 15px;
            left: 25px;
            font-size: 30px;
            font-weight: bold;
            cursor: pointer;
            color: #f39c12;
        }

        .modal-title {
            font-size: 2em;
            margin-bottom: 20px;
            color: #f39c12;
            text-align: center;
        }

        .modal-text {
            font-size: 1.1em;
            line-height: 1.8;
            margin-bottom: 20px;
        }

        .game-section {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            border: 2px solid #f39c12;
        }

        .game-section h3 {
            color: #f39c12;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .mini-game {
            text-align: center;
            padding: 20px;
        }

        .game-button {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 15px 25px;
            font-size: 1em;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
        }

        .game-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }

        .game-button:disabled {
            background: #7f8c8d;
            cursor: not-allowed;
            transform: none;
        }

        .complete-btn {
            background: linear-gradient(45deg, #27ae60, #2ecc71);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.1em;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            margin: 20px auto;
        }

        .complete-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(39, 174, 96, 0.4);
        }

        .complete-btn:disabled {
            background: #7f8c8d;
            cursor: not-allowed;
            transform: none;
        }

        .completion-message {
            text-align: center;
            padding: 30px;
            background: rgba(39, 174, 96, 0.2);
            border-radius: 15px;
            margin: 20px 0;
            display: none;
        }

        .completion-message h2 {
            color: #27ae60;
            margin-bottom: 15px;
            font-size: 2em;
        }

        .restart-btn {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.1em;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
        }

        .restart-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(231, 76, 60, 0.4);
        }

        .info-panel {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
        }

        .ritual-icon {
            font-size: 3em;
            margin-bottom: 10px;
            display: block;
            text-align: center;
        }

        .score-display {
            font-size: 1.2em;
            font-weight: bold;
            color: #f39c12;
            margin: 10px 0;
        }

        .feedback {
            padding: 10px;
            margin: 10px 0;
            border-radius: 10px;
            font-weight: bold;
        }

        .feedback.success {
            background: rgba(39, 174, 96, 0.3);
            color: #27ae60;
        }

        .feedback.error {
            background: rgba(231, 76, 60, 0.3);
            color: #e74c3c;
        }

        /* --- ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„Ø·ÙˆØ§Ù Ù„Ø¬Ø¹Ù„Ù‡ Ø¯Ø§Ø¦Ø±ÙŠÙ‹Ø§ --- */
        .tawaf-circle {
            width: 200px;
            height: 200px;
            border: 3px solid #f39c12;
            border-radius: 50%;
            position: relative;
            margin: 20px auto;
            background: rgba(243, 156, 18, 0.1);
            display: flex; /* Ù„Ù…Ø±ÙƒØ²Ø© Ø§Ù„ÙƒØ¹Ø¨Ø© */
            justify-content: center; /* Ù„Ù…Ø±ÙƒØ²Ø© Ø§Ù„ÙƒØ¹Ø¨Ø© */
            align-items: center; /* Ù„Ù…Ø±ÙƒØ²Ø© Ø§Ù„ÙƒØ¹Ø¨Ø© */
        }

        .kaaba {
            width: 40px;
            height: 40px;
            background: #2c3e50;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border-radius: 5px;
            z-index: 10;
        }

        .pilgrim {
            width: 20px;
            height: 20px;
            background: #27ae60;
            border-radius: 50%;
            position: absolute;
            top: 0; /* ÙŠØ¨Ø¯Ø£ Ù…Ù† Ø£Ø¹Ù„Ù‰ Ø§Ù„Ø¯Ø§Ø¦Ø±Ø© */
            left: 50%; /* ÙÙŠ Ù…Ù†ØªØµÙ Ø§Ù„Ø¹Ø±Ø¶ */
            transform: translateX(-50%); /* Ù„Ù…Ø±ÙƒØ²Ø© Ø§Ù„Ø·Ø§Ø¦Ù Ù†ÙØ³Ù‡ Ø£ÙÙ‚ÙŠØ§Ù‹ */
            transform-origin: 50% 100px; /* Ù†Ù‚Ø·Ø© Ø§Ù„Ø¯ÙˆØ±Ø§Ù†: Ù…Ù†ØªØµÙ Ø§Ù„Ø¯Ø§Ø¦Ø±Ø© Ø§Ù„Ø£Ù… (Ù†ØµÙ Ø§Ù„Ù‚Ø·Ø± 100px) */
            transition: transform 0.8s ease-out; /* Ø­Ø±ÙƒØ© Ø¯ÙˆØ±Ø§Ù† Ø³Ù„Ø³Ø© */
            z-index: 1;
        }
        /* --- Ù†Ù‡Ø§ÙŠØ© ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„Ø·ÙˆØ§Ù --- */

        .choice-button {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid #3498db;
            color: white;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            width: 100%;
            text-align: right;
        }

        .choice-button:hover {
            background: rgba(52, 152, 219, 0.3);
        }

        .choice-button.correct {
            background: rgba(39, 174, 96, 0.3);
            border-color: #27ae60;
        }

        .choice-button.incorrect {
            background: rgba(231, 76, 60, 0.3);
            border-color: #e74c3c;
        }

        .timer {
            font-size: 1.5em;
            color: #f39c12;
            margin: 10px 0;
        }

        .stone-container {
            display: flex;
            flex-wrap: wrap; /* Ù„Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„Ø§Ù„ØªÙØ§Ù Ù„Ø£Ø³Ø·Ø± Ù…ØªØ¹Ø¯Ø¯Ø© */
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
        }

        .stone {
            width: 40px;
            height: 40px;
            background: #8B4513; /* Ù„ÙˆÙ† Ø¨Ù†ÙŠ Ù„Ù„Ø­ØµÙ‰ */
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
            color: white;
            font-weight: bold;
        }

        .stone:hover {
            transform: scale(1.1);
            background: #a0522d; /* Ù„ÙˆÙ† Ø£ØºÙ…Ù‚ Ø¹Ù†Ø¯ Ø§Ù„ØªØ­ÙˆÙŠÙ… */
        }

        .stone.collected {
            background: #27ae60; /* Ù„ÙˆÙ† Ø£Ø®Ø¶Ø± Ù„Ù„Ø­ØµÙ‰ Ø§Ù„Ù…Ø¬Ù…Ø¹Ø© */
            cursor: default;
            opacity: 0.7;
            transform: none;
        }

        .jamrat {
            width: 120px;
            height: 120px;
            background: #7f8c8d; /* Ù„ÙˆÙ† Ø±Ù…Ø§Ø¯ÙŠ Ù„Ù„Ø¬Ù…Ø±Ø© */
            border-radius: 50%;
            margin: 20px auto;
            position: relative;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2em;
            font-weight: bold;
            color: white;
            border: 3px solid #6c7a89;
        }

        .jamrat.hit {
            background: #27ae60;
            animation: hit 0.5s ease;
        }

        @keyframes hit {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        /* Styling for Hady/Tahallul buttons */
        .hady-choice-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 20px;
        }
        .hady-choice-container button {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid #f39c12;
            color: white;
            padding: 15px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.1em;
            transition: all 0.3s ease;
        }
        .hady-choice-container button:hover {
            background: rgba(243, 156, 18, 0.3);
        }
        .hady-choice-container button.selected {
            background: #f39c12;
            color: #2c3e50;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .game-board {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .modal-content {
                width: 98%;
                margin: 5% auto;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="header">
            <h1>ğŸ•‹ Ù…Ø­Ø§ÙƒØ§Ø© Ù…Ù†Ø§Ø³Ùƒ Ø§Ù„Ø­Ø¬ Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©</h1>
            <p>ØªØ¹Ù„Ù… Ù…Ù†Ø§Ø³Ùƒ Ø§Ù„Ø­Ø¬ Ø®Ø·ÙˆØ© Ø¨Ø®Ø·ÙˆØ© Ù…Ø¹ Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©</p>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div id="progressText">Ø§Ù„Ù…Ø±Ø­Ù„Ø©: 0 Ù…Ù† 10</div>
        </div>

        <div class="info-panel">
            <h3>ğŸ¯ Ø§Ù„Ù‡Ø¯Ù Ù…Ù† Ø§Ù„Ù„Ø¹Ø¨Ø©:</h3>
            <p>ØªØ¹Ù„Ù… Ù…Ù†Ø§Ø³Ùƒ Ø§Ù„Ø­Ø¬ Ø¨Ø§Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„ØµØ­ÙŠØ­ Ù…Ø¹ Ù„Ø¹Ø¨Ø© ØªÙØ§Ø¹Ù„ÙŠØ© Ù„ÙƒÙ„ Ù…Ù†Ø³Ùƒ. Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ ÙƒÙ„ Ù…Ù†Ø³Ùƒ Ù„ØªØ¹Ù„Ù… ØªÙØ§ØµÙŠÙ„Ù‡ ÙˆÙ„Ø¹Ø¨ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø§Ù„Ù…Ø®ØµØµØ© Ù„Ù‡.</p>
        </div>

        <div class="game-board" id="gameBoard">
        </div>

        <div class="completion-message" id="completionMessage">
            <h2>ğŸ‰ Ù…Ø¨Ø±ÙˆÙƒ! Ù„Ù‚Ø¯ Ø£ØªÙ…Ù…Øª Ù…Ù†Ø§Ø³Ùƒ Ø§Ù„Ø­Ø¬ Ø¨Ù†Ø¬Ø§Ø­!</h2>
            <p>Ù„Ù‚Ø¯ ØªØ¹Ù„Ù…Øª Ø¬Ù…ÙŠØ¹ Ù…Ù†Ø§Ø³Ùƒ Ø§Ù„Ø­Ø¬ Ø¨Ø§Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„ØµØ­ÙŠØ­ ÙˆÙ„Ø¹Ø¨Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©. ØªÙ‚Ø¨Ù„ Ø§Ù„Ù„Ù‡ Ù…Ù†Ùƒ!</p>
            <button class="restart-btn" onclick="restartGame()">Ø§Ø¨Ø¯Ø£ Ù…Ù† Ø¬Ø¯ÙŠØ¯</button>
        </div>
    </div>

    <div id="ritualModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2 class="modal-title" id="modalTitle"></h2>
            <div class="modal-text" id="modalText"></div>
            
            <div class="game-section">
                <h3>ğŸ® Ø§Ù„Ù„Ø¹Ø¨Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©</h3>
                <div class="mini-game" id="miniGame">
                </div>
                <div class="score-display" id="scoreDisplay">Ø§Ù„Ù†Ù‚Ø§Ø·: 0</div>
                <div class="feedback" id="feedback" style="display: none;"></div>
            </div>

            <button class="complete-btn" id="completeBtn" onclick="completeRitual()" disabled>Ø£ÙƒÙ…Ù„ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø£ÙˆÙ„Ø§Ù‹</button>
        </div>
    </div>

    <script>
        const hajjRituals = [
            {
                id: 1,
                title: "Ø§Ù„Ø¥Ø­Ø±Ø§Ù…",
                icon: "ğŸ¤²",
                description: "Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ù…Ù‚Ø¯Ø³Ø© - Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙÙŠ Ø§Ù„Ù†Ø³Ùƒ",
                detailedDescription: "ÙŠØ¨Ø¯Ø£ Ø§Ù„Ø­Ø§Ø¬ Ø¨Ø§Ù„Ø¥Ø­Ø±Ø§Ù… Ù…Ù† Ø§Ù„Ù…ÙŠÙ‚Ø§ØªØŒ ÙˆÙ‡Ùˆ Ø§Ù„Ù…ÙƒØ§Ù† Ø§Ù„Ù…Ø®ØµØµ Ù„Ù„Ø¥Ø­Ø±Ø§Ù…. ÙŠÙ„Ø¨Ø³ Ø§Ù„Ø±Ø¬Ù„ Ø¥Ø²Ø§Ø±Ø§Ù‹ ÙˆØ±Ø¯Ø§Ø¡Ù‹ Ø£Ø¨ÙŠØ¶ÙŠÙ†ØŒ ÙˆØªÙ„Ø¨Ø³ Ø§Ù„Ù…Ø±Ø£Ø© Ù…Ù„Ø§Ø¨Ø³ Ø³Ø§ØªØ±Ø©. ÙŠÙ†ÙˆÙŠ Ø§Ù„Ø­Ø§Ø¬ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙÙŠ Ø§Ù„Ù†Ø³Ùƒ Ù…Ø¹ Ø§Ù„ØªÙ„Ø¨ÙŠØ©: 'Ù„Ø¨ÙŠÙƒ Ø§Ù„Ù„Ù‡Ù… Ù„Ø¨ÙŠÙƒØŒ Ù„Ø¨ÙŠÙƒ Ù„Ø§ Ø´Ø±ÙŠÙƒ Ù„Ùƒ Ù„Ø¨ÙŠÙƒØŒ Ø¥Ù† Ø§Ù„Ø­Ù…Ø¯ ÙˆØ§Ù„Ù†Ø¹Ù…Ø© Ù„Ùƒ ÙˆØ§Ù„Ù…Ù„ÙƒØŒ Ù„Ø§ Ø´Ø±ÙŠÙƒ Ù„Ùƒ'.",
                completed: false,
                current: true,
                gameCompleted: false
            },
            {
                id: 2,
                title: "Ø§Ù„Ø·ÙˆØ§Ù",
                icon: "ğŸ•‹",
                description: "Ø§Ù„Ø·ÙˆØ§Ù Ø­ÙˆÙ„ Ø§Ù„ÙƒØ¹Ø¨Ø© Ø§Ù„Ù…Ø´Ø±ÙØ©",
                detailedDescription: "Ø¨Ø¹Ø¯ Ø§Ù„Ø¥Ø­Ø±Ø§Ù…ØŒ ÙŠØªÙˆØ¬Ù‡ Ø§Ù„Ø­Ø§Ø¬ Ø¥Ù„Ù‰ Ù…ÙƒØ© Ø§Ù„Ù…ÙƒØ±Ù…Ø© Ù„Ø£Ø¯Ø§Ø¡ Ø·ÙˆØ§Ù Ø§Ù„Ù‚Ø¯ÙˆÙ…. ÙŠØ·ÙˆÙ Ø¨Ø§Ù„ÙƒØ¹Ø¨Ø© Ø³Ø¨Ø¹Ø© Ø£Ø´ÙˆØ§Ø·ØŒ ÙŠØ¨Ø¯Ø£ Ù…Ù† Ø§Ù„Ø­Ø¬Ø± Ø§Ù„Ø£Ø³ÙˆØ¯ ÙˆÙŠÙ†ØªÙ‡ÙŠ Ø¨Ù‡. ÙŠØ³ØªØ­Ø¨ Ø§Ù„Ø§Ø¶Ø·Ø¨Ø§Ø¹ Ù„Ù„Ø±Ø¬Ø§Ù„ (ÙƒØ´Ù Ø§Ù„ÙƒØªÙ Ø§Ù„Ø£ÙŠÙ…Ù†) ÙˆØ§Ù„Ø±Ù…Ù„ (Ø§Ù„Ø¥Ø³Ø±Ø§Ø¹) ÙÙŠ Ø§Ù„Ø£Ø´ÙˆØ§Ø· Ø§Ù„Ø«Ù„Ø§Ø«Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰.",
                completed: false,
                current: false,
                gameCompleted: false
            },
            {
                id: 3,
                title: "Ø§Ù„Ø³Ø¹ÙŠ",
                icon: "ğŸš¶â€â™‚ï¸",
                description: "Ø§Ù„Ø³Ø¹ÙŠ Ø¨ÙŠÙ† Ø§Ù„ØµÙØ§ ÙˆØ§Ù„Ù…Ø±ÙˆØ©",
                detailedDescription: "Ø¨Ø¹Ø¯ Ø§Ù„Ø·ÙˆØ§ÙØŒ ÙŠÙ‚ÙˆÙ… Ø§Ù„Ø­Ø§Ø¬ Ø¨Ø§Ù„Ø³Ø¹ÙŠ Ø¨ÙŠÙ† Ø§Ù„ØµÙØ§ ÙˆØ§Ù„Ù…Ø±ÙˆØ© Ø³Ø¨Ø¹Ø© Ø£Ø´ÙˆØ§Ø·. ÙŠØ¨Ø¯Ø£ Ø¨Ø§Ù„ØµÙØ§ ÙˆÙŠÙ†ØªÙ‡ÙŠ Ø¨Ø§Ù„Ù…Ø±ÙˆØ©. ÙŠØ³ØªØ­Ø¨ Ø§Ù„Ø¥Ø³Ø±Ø§Ø¹ Ù„Ù„Ø±Ø¬Ø§Ù„ ÙÙŠ Ø§Ù„Ù…Ø³Ø¹Ù‰ Ø§Ù„Ø£Ø®Ø¶Ø± Ø¨ÙŠÙ† Ø§Ù„Ø¹Ù„Ù…ÙŠÙ† Ø§Ù„Ø£Ø®Ø¶Ø±ÙŠÙ†. Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†Ø³Ùƒ ÙŠØ­Ø§ÙƒÙŠ Ù‚ØµØ© Ù‡Ø§Ø¬Ø± Ø£Ù… Ø¥Ø³Ù…Ø§Ø¹ÙŠÙ„ Ø¹Ù„ÙŠÙ‡Ù…Ø§ Ø§Ù„Ø³Ù„Ø§Ù….",
                completed: false,
                current: false,
                gameCompleted: false
            },
            {
                id: 4,
                title: "Ø§Ù„ÙˆÙ‚ÙˆÙ Ø¨Ø¹Ø±ÙØ©",
                icon: "ğŸŒ…",
                description: "Ø§Ù„ÙˆÙ‚ÙˆÙ Ø¨Ø¹Ø±ÙØ© - Ø±ÙƒÙ† Ø§Ù„Ø­Ø¬ Ø§Ù„Ø£Ø¹Ø¸Ù…",
                detailedDescription: "ÙÙŠ Ø§Ù„ÙŠÙˆÙ… Ø§Ù„ØªØ§Ø³Ø¹ Ù…Ù† Ø°ÙŠ Ø§Ù„Ø­Ø¬Ø©ØŒ ÙŠØªÙˆØ¬Ù‡ Ø§Ù„Ø­Ø¬Ø§Ø¬ Ø¥Ù„Ù‰ Ø¹Ø±ÙØ© Ù„Ù„ÙˆÙ‚ÙˆÙ Ø¨Ù‡Ø§ Ù…Ù† Ø¨Ø¹Ø¯ Ø²ÙˆØ§Ù„ Ø§Ù„Ø´Ù…Ø³ Ø­ØªÙ‰ ØºØ±ÙˆØ¨Ù‡Ø§. Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„Ø±ÙƒÙ† Ø§Ù„Ø£Ø¹Ø¸Ù… Ù„Ù„Ø­Ø¬ØŒ ÙˆÙ‚Ø¯ Ù‚Ø§Ù„ Ø§Ù„Ù†Ø¨ÙŠ ï·º: 'Ø§Ù„Ø­Ø¬ Ø¹Ø±ÙØ©'. ÙŠØ³ØªØ­Ø¨ Ø§Ù„Ø¥ÙƒØ«Ø§Ø± Ù…Ù† Ø§Ù„Ø¯Ø¹Ø§Ø¡ ÙˆØ§Ù„ØªØ¶Ø±Ø¹ Ø¥Ù„Ù‰ Ø§Ù„Ù„Ù‡ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆÙ‚Ù Ø§Ù„Ø¹Ø¸ÙŠÙ….",
                completed: false,
                current: false,
                gameCompleted: false
            },
            {
                id: 5,
                title: "Ø§Ù„Ù…Ø¨ÙŠØª Ø¨Ù…Ø²Ø¯Ù„ÙØ©",
                icon: "ğŸŒ™",
                description: "Ø§Ù„Ù…Ø¨ÙŠØª Ø¨Ù…Ø²Ø¯Ù„ÙØ© ÙˆØ¬Ù…Ø¹ Ø§Ù„Ø­ØµÙ‰",
                detailedDescription: "Ø¨Ø¹Ø¯ ØºØ±ÙˆØ¨ Ø´Ù…Ø³ Ø¹Ø±ÙØ©ØŒ ÙŠØªÙˆØ¬Ù‡ Ø§Ù„Ø­Ø¬Ø§Ø¬ Ø¥Ù„Ù‰ Ù…Ø²Ø¯Ù„ÙØ© Ù„Ù„Ù…Ø¨ÙŠØª Ø¨Ù‡Ø§. ÙŠØµÙ„ÙˆÙ† Ø§Ù„Ù…ØºØ±Ø¨ ÙˆØ§Ù„Ø¹Ø´Ø§Ø¡ Ø¬Ù…Ø¹Ø§Ù‹ ÙˆÙ‚ØµØ±Ø§Ù‹. ÙŠØ³ØªØ­Ø¨ Ø§Ù„Ø¥ÙƒØ«Ø§Ø± Ù…Ù† Ø§Ù„Ø°ÙƒØ± ÙˆØ§Ù„Ø¯Ø¹Ø§Ø¡ØŒ ÙˆØ¬Ù…Ø¹ Ø§Ù„Ø­ØµÙ‰ Ù„Ø±Ù…ÙŠ Ø§Ù„Ø¬Ù…Ø±Ø§Øª. ÙŠØ¨Ù‚Ù‰ Ø§Ù„Ø­Ø¬Ø§Ø¬ ÙÙŠ Ù…Ø²Ø¯Ù„ÙØ© Ø­ØªÙ‰ ÙØ¬Ø± Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø¹Ø§Ø´Ø±.",
                completed: false,
                current: false,
                gameCompleted: false
            },
            {
                id: 6,
                title: "Ø±Ù…ÙŠ Ø§Ù„Ø¬Ù…Ø±Ø§Øª",
                icon: "â›°ï¸",
                description: "Ø±Ù…ÙŠ Ø¬Ù…Ø±Ø© Ø§Ù„Ø¹Ù‚Ø¨Ø© Ø§Ù„ÙƒØ¨Ø±Ù‰",
                detailedDescription: "ÙÙŠ Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø¹Ø§Ø´Ø± Ù…Ù† Ø°ÙŠ Ø§Ù„Ø­Ø¬Ø© (ÙŠÙˆÙ… Ø§Ù„Ù†Ø­Ø±)ØŒ ÙŠØ±Ù…ÙŠ Ø§Ù„Ø­Ø¬Ø§Ø¬ Ø¬Ù…Ø±Ø© Ø§Ù„Ø¹Ù‚Ø¨Ø© Ø§Ù„ÙƒØ¨Ø±Ù‰ Ø¨Ø³Ø¨Ø¹ Ø­ØµÙŠØ§Øª. ÙŠÙƒØ¨Ø± Ù…Ø¹ ÙƒÙ„ Ø­ØµØ§Ø©. Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†Ø³Ùƒ ÙŠØ­Ø§ÙƒÙŠ ÙØ¹Ù„ Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø¹Ù„ÙŠÙ‡ Ø§Ù„Ø³Ù„Ø§Ù… Ø¹Ù†Ø¯Ù…Ø§ Ø±Ù…Ù‰ Ø§Ù„Ø´ÙŠØ·Ø§Ù† Ø§Ù„Ø°ÙŠ Ø­Ø§ÙˆÙ„ Ø¥ØºÙˆØ§Ø¡Ù‡ Ø¹Ù† Ø°Ø¨Ø­ Ø§Ø¨Ù†Ù‡ Ø¥Ø³Ù…Ø§Ø¹ÙŠÙ„.",
                completed: false,
                current: false,
                gameCompleted: false
            },
            {
                id: 7,
                title: "Ø§Ù„Ù‡Ø¯ÙŠ ÙˆØ§Ù„ØªØ­Ù„Ù„",
                icon: "âœ‚ï¸",
                description: "Ø°Ø¨Ø­ Ø§Ù„Ù‡Ø¯ÙŠ ÙˆØ§Ù„ØªØ­Ù„Ù„ Ù…Ù† Ø§Ù„Ø¥Ø­Ø±Ø§Ù…",
                detailedDescription: "Ø¨Ø¹Ø¯ Ø±Ù…ÙŠ Ø¬Ù…Ø±Ø© Ø§Ù„Ø¹Ù‚Ø¨Ø©ØŒ ÙŠÙ‚ÙˆÙ… Ø§Ù„Ø­Ø§Ø¬ Ø¨Ø°Ø¨Ø­ Ø§Ù„Ù‡Ø¯ÙŠ (Ø¥Ù† ÙˆØ¬Ø¨ Ø¹Ù„ÙŠÙ‡) Ø«Ù… ÙŠØªØ­Ù„Ù„ Ù…Ù† Ø¥Ø­Ø±Ø§Ù…Ù‡. ÙŠØ­Ù„Ù‚ Ø§Ù„Ø±Ø¬Ù„ Ø±Ø£Ø³Ù‡ Ø£Ùˆ ÙŠÙ‚ØµØ±Ù‡ØŒ ÙˆØªØ£Ø®Ø° Ø§Ù„Ù…Ø±Ø£Ø© Ù…Ù† Ø£Ø·Ø±Ø§Ù Ø´Ø¹Ø±Ù‡Ø§. Ø¨Ø¹Ø¯ Ø°Ù„Ùƒ ÙŠØ­Ù„ Ù„Ù‡ ÙƒÙ„ Ø´ÙŠØ¡ Ø¥Ù„Ø§ Ø§Ù„Ù†Ø³Ø§Ø¡ Ø­ØªÙ‰ ÙŠØ·ÙˆÙ Ø·ÙˆØ§Ù Ø§Ù„Ø¥ÙØ§Ø¶Ø©.",
                completed: false,
                current: false,
                gameCompleted: false
            },
            {
                id: 8,
                title: "Ø·ÙˆØ§Ù Ø§Ù„Ø¥ÙØ§Ø¶Ø©",
                icon: "ğŸ”„",
                description: "Ø·ÙˆØ§Ù Ø§Ù„Ø¥ÙØ§Ø¶Ø© - Ø±ÙƒÙ† Ù…Ù† Ø£Ø±ÙƒØ§Ù† Ø§Ù„Ø­Ø¬",
                detailedDescription: "Ø¨Ø¹Ø¯ Ø§Ù„ØªØ­Ù„Ù„ØŒ ÙŠØ¹ÙˆØ¯ Ø§Ù„Ø­Ø§Ø¬ Ø¥Ù„Ù‰ Ù…ÙƒØ© Ù„Ø£Ø¯Ø§Ø¡ Ø·ÙˆØ§Ù Ø§Ù„Ø¥ÙØ§Ø¶Ø© Ø¨Ø§Ù„ÙƒØ¹Ø¨Ø© Ø³Ø¨Ø¹Ø© Ø£Ø´ÙˆØ§Ø·. Ù‡Ø°Ø§ Ø·ÙˆØ§Ù Ø±ÙƒÙ† Ù…Ù† Ø£Ø±ÙƒØ§Ù† Ø§Ù„Ø­Ø¬ Ù„Ø§ ÙŠØªÙ… Ø§Ù„Ø­Ø¬ Ø¨Ø¯ÙˆÙ†Ù‡. Ø¨Ø¹Ø¯ Ù‡Ø°Ø§ Ø§Ù„Ø·ÙˆØ§Ù ÙŠØ­Ù„ Ù„Ù„Ø­Ø§Ø¬ ÙƒÙ„ Ø´ÙŠØ¡ Ø­ØªÙ‰ Ø§Ù„Ù†Ø³Ø§Ø¡ Ø¥Ø°Ø§ Ø³Ø¹Ù‰ Ø¨Ø¹Ø¯Ù‡ (Ø¥Ù† Ù„Ù… ÙŠÙƒÙ† Ø³Ø¹Ù‰ Ù…Ù† Ù‚Ø¨Ù„).",
                completed: false,
                current: false,
                gameCompleted: false
            },
            {
                id: 9,
                title: "Ø·ÙˆØ§Ù Ø§Ù„ÙˆØ¯Ø§Ø¹",
                icon: "ğŸ‘‹",
                description: "Ø·ÙˆØ§Ù Ø§Ù„ÙˆØ¯Ø§Ø¹ - Ø¢Ø®Ø± Ø¹Ù‡Ø¯ Ø¨Ø§Ù„Ø¨ÙŠØª",
                detailedDescription: "Ù‚Ø¨Ù„ Ù…ØºØ§Ø¯Ø±Ø© Ù…ÙƒØ©ØŒ ÙŠÙ‚ÙˆÙ… Ø§Ù„Ø­Ø§Ø¬ Ø¨Ø·ÙˆØ§Ù Ø§Ù„ÙˆØ¯Ø§Ø¹ Ø¨Ø§Ù„ÙƒØ¹Ø¨Ø© Ø³Ø¨Ø¹Ø© Ø£Ø´ÙˆØ§Ø·. Ù‡Ø°Ø§ Ø¢Ø®Ø± Ø¹Ù‡Ø¯ Ø¨Ø§Ù„Ø¨ÙŠØª Ø§Ù„Ø­Ø±Ø§Ù…ØŒ ÙˆÙŠØ³ØªØ­Ø¨ Ø§Ù„Ø¥ÙƒØ«Ø§Ø± Ù…Ù† Ø§Ù„Ø¯Ø¹Ø§Ø¡ ÙˆØ§Ù„ØªØ¶Ø±Ø¹. ÙŠØ³Ù‚Ø· Ø·ÙˆØ§Ù Ø§Ù„ÙˆØ¯Ø§Ø¹ Ø¹Ù† Ø§Ù„Ø­Ø§Ø¦Ø¶ ÙˆØ§Ù„Ù†ÙØ³Ø§Ø¡ØŒ ÙˆÙ„Ø§ ÙŠØ¬ÙˆØ² Ø§Ù„ØªØ£Ø®ÙŠØ± Ø¨Ø¹Ø¯Ù‡ Ø¥Ù„Ø§ Ù„Ø­Ø§Ø¬Ø©.",
                completed: false,
                current: false,
                gameCompleted: false
            },
            {
                id: 10,
                title: "Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø­Ø¬",
                icon: "ğŸŠ",
                description: "Ø¥ØªÙ…Ø§Ù… Ù…Ù†Ø§Ø³Ùƒ Ø§Ù„Ø­Ø¬ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„",
                detailedDescription: "Ø¨Ø¹Ø¯ Ø·ÙˆØ§Ù Ø§Ù„ÙˆØ¯Ø§Ø¹ØŒ ÙŠÙƒÙˆÙ† Ø§Ù„Ø­Ø§Ø¬ Ù‚Ø¯ Ø£ØªÙ… Ù…Ù†Ø§Ø³Ùƒ Ø§Ù„Ø­Ø¬. ØªÙ‚Ø¨Ù„ Ø§Ù„Ù„Ù‡ Ù…Ù†Ù‡ Ø­Ø¬Ù‡ ÙˆØ¬Ø¹Ù„Ù‡ Ù…Ø¨Ø±ÙˆØ±Ø§Ù‹. Ø§Ù„Ø­Ø¬ Ø§Ù„Ù…Ø¨Ø±ÙˆØ± Ù„ÙŠØ³ Ù„Ù‡ Ø¬Ø²Ø§Ø¡ Ø¥Ù„Ø§ Ø§Ù„Ø¬Ù†Ø©. ÙŠØ³ØªØ­Ø¨ Ù„Ù„Ø­Ø§Ø¬ Ø§Ù„Ø¥ÙƒØ«Ø§Ø± Ù…Ù† Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„ØµØ§Ù„Ø­Ø© ÙˆØ§Ù„Ù…Ø­Ø§ÙØ¸Ø© Ø¹Ù„Ù‰ Ù…Ø§ ØªØ¹Ù„Ù…Ù‡ Ù…Ù† Ù‡Ø°Ù‡ Ø§Ù„Ø±Ø­Ù„Ø© Ø§Ù„Ù…Ø¨Ø§Ø±ÙƒØ©.",
                completed: false,
                current: false,
                gameCompleted: false
            }
        ];

        let currentRitualIndex = 0;
        let selectedRitual = null;
        let gameScore = 0;
        
        // Game-specific variables (reset in loadMiniGame)
        let tawafRounds = 0;
        let saeiRounds = 0;
        let ihramAnswered = false;
        let arafatPrayed = false;
        let arafatTimer = null; // for Arafat game timer
        let arafatPrayTime = 0; // tracks time spent praying
        let muzdalifaCollected = 0;
        let jamaratThrown = 0;
        let hadyDone = false;
        let ifadaTawafRounds = 0;
        let wadaTawafRounds = 0;

        let pilgrimAngle = 0; // Ø§Ù„Ø²Ø§ÙˆÙŠØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù„Ù„Ø·Ø§Ø¦Ù Ø¨Ø§Ù„Ø¯Ø±Ø¬Ø§Øª
        const degreesPerRound = 360; // Ø¯ÙˆØ±Ø© ÙƒØ§Ù…Ù„Ø© 360 Ø¯Ø±Ø¬Ø©

        function initializeGame() {
            // Reset all rituals to not completed, and set the first one as current
            hajjRituals.forEach((ritual, index) => {
                ritual.completed = false;
                ritual.current = (index === 0);
                ritual.gameCompleted = false;
            });
            currentRitualIndex = 0;

            renderRituals();
            updateProgress();
            document.getElementById('completionMessage').style.display = 'none'; // Hide completion message on init
        }

        function renderRituals() {
            const gameBoard = document.getElementById('gameBoard');
            gameBoard.innerHTML = '';

            hajjRituals.forEach((ritual, index) => {
                const ritualCard = document.createElement('div');
                ritualCard.className = 'ritual-card';
                
                if (ritual.completed) {
                    ritualCard.classList.add('completed');
                } else if (index === currentRitualIndex) {
                    ritualCard.classList.add('current');
                } else if (index > currentRitualIndex) {
                    ritualCard.classList.add('locked');
                }

                ritualCard.innerHTML = `
                    <div class="ritual-number">${ritual.id}</div>
                    <div class="ritual-icon">${ritual.icon}</div>
                    <h3 class="ritual-title">${ritual.title}</h3>
                    <p class="ritual-description">${ritual.description}</p>
                    <span class="ritual-status ${getStatusClass(ritual, index)}">
                        ${getStatusText(ritual, index)}
                    </span>
                `;

                if (index <= currentRitualIndex) {
                    ritualCard.addEventListener('click', () => openRitualModal(ritual));
                }

                gameBoard.appendChild(ritualCard);
            });
        }

        function getStatusClass(ritual, index) {
            if (ritual.completed) return 'status-completed';
            if (index === currentRitualIndex) return 'status-current';
            return 'status-locked';
        }

        function getStatusText(ritual, index) {
            if (ritual.completed) return 'âœ… Ù…ÙƒØªÙ…Ù„';
            if (index === currentRitualIndex) return 'ğŸ”„ Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©';
            return 'ğŸ”’ Ù…Ù‚ÙÙ„';
        }

        function updateProgress() {
            const completedRituals = hajjRituals.filter(r => r.completed).length;
            const totalRituals = hajjRituals.length;
            const progressPercentage = (completedRituals / totalRituals) * 100;

            document.getElementById('progressFill').style.width = `${progressPercentage}%`;
            document.getElementById('progressText').textContent = `Ø§Ù„Ù…Ø±Ø­Ù„Ø©: ${completedRituals} Ù…Ù† ${totalRituals}`;

            if (completedRituals === totalRituals) {
                document.getElementById('completionMessage').style.display = 'block';
            } else {
                document.getElementById('completionMessage').style.display = 'none';
            }
        }

        function openRitualModal(ritual) {
            selectedRitual = ritual;
            gameScore = 0; // Reset score for each game
            document.getElementById('modalTitle').textContent = ritual.title;
            document.getElementById('modalText').textContent = ritual.detailedDescription;
            document.getElementById('scoreDisplay').textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${gameScore}`;
            document.getElementById('feedback').style.display = 'none';
            
            const completeBtn = document.getElementById('completeBtn');
            if (ritual.completed) {
                completeBtn.textContent = 'ØªÙ… Ø¥ØªÙ…Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†Ø³Ùƒ';
                completeBtn.disabled = true;
                completeBtn.style.opacity = '0.5';
            } else {
                completeBtn.textContent = ritual.gameCompleted ? 'Ø¥ØªÙ…Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†Ø³Ùƒ' : 'Ø£ÙƒÙ…Ù„ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø£ÙˆÙ„Ø§Ù‹';
                completeBtn.disabled = !ritual.gameCompleted;
                completeBtn.style.opacity = ritual.gameCompleted ? '1' : '0.5';
            }

            loadMiniGame(ritual);
            document.getElementById('ritualModal').style.display = 'block';
        }

        function closeModal() {
            document.getElementById('ritualModal').style.display = 'none';
            // Clear any active game timers/intervals when closing modal
            if (arafatTimer) {
                clearInterval(arafatTimer);
                arafatTimer = null;
            }

            // Reset game-specific flags when closing modal if ritual not completed
            if (selectedRitual && !selectedRitual.completed) {
                selectedRitual.gameCompleted = false; // Reset game completion status if not fully completed
            }
            renderRituals(); // Re-render to update statuses
        }

        function completeRitual() {
            if (selectedRitual && selectedRitual.gameCompleted) {
                selectedRitual.completed = true;
                selectedRitual.gameCompleted = false; // Reset game state for next time (if game is revisited)
                
                // Advance currentRitualIndex if the completed ritual was the current one
                if (hajjRituals[currentRitualIndex].id === selectedRitual.id && currentRitualIndex < hajjRituals.length - 1) {
                    hajjRituals[currentRitualIndex].current = false; // Mark old current as false
                    currentRitualIndex++;
                    hajjRituals[currentRitualIndex].current = true; // Mark new current as true
                }
                closeModal();
                updateProgress();
                renderRituals(); // Re-render to update statuses
            }
        }

        function restartGame() {
            initializeGame(); // Re-initialize game state
        }

        function showFeedback(message, type) {
            const feedbackDiv = document.getElementById('feedback');
            feedbackDiv.textContent = message;
            feedbackDiv.className = `feedback ${type}`;
            feedbackDiv.style.display = 'block';
        }

        // --- Mini-Games Implementations ---

        function loadMiniGame(ritual) {
            const miniGameDiv = document.getElementById('miniGame');
            miniGameDiv.innerHTML = ''; // Clear previous game content
            
            // Reset all game-specific flags for the currently selected ritual's game
            tawafRounds = 0;
            saeiRounds = 0;
            ihramAnswered = false;
            arafatPrayed = false;
            if (arafatTimer) {
                clearInterval(arafatTimer);
                arafatTimer = null;
            }
            arafatPrayTime = 0;
            muzdalifaCollected = 0;
            jamaratThrown = 0;
            hadyDone = false;
            ifadaTawafRounds = 0;
            wadaTawafRounds = 0;
            pilgrimAngle = 0; // Reset pilgrim angle for any tawaf game

            // Check if ritual.gameCompleted is already true (e.g., if re-opening a completed ritual's modal)
            const completeBtn = document.getElementById('completeBtn');
            if (ritual.completed) {
                completeBtn.textContent = 'ØªÙ… Ø¥ØªÙ…Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†Ø³Ùƒ';
                completeBtn.disabled = true;
                completeBtn.style.opacity = '0.5';
            } else {
                completeBtn.textContent = 'Ø£ÙƒÙ…Ù„ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø£ÙˆÙ„Ø§Ù‹';
                completeBtn.disabled = true;
                completeBtn.style.opacity = '0.5';
            }

            switch(ritual.id) {
                case 1: // Ø§Ù„Ø¥Ø­Ø±Ø§Ù…
                    loadIhramGame(miniGameDiv);
                    break;
                case 2: // Ø§Ù„Ø·ÙˆØ§Ù (Ø·ÙˆØ§Ù Ø§Ù„Ù‚Ø¯ÙˆÙ…)
                    loadTawafGame(miniGameDiv, 'tawafCounter', 7, 'selectedRitual.gameCompleted = true;');
                    break;
                case 3: // Ø§Ù„Ø³Ø¹ÙŠ
                    loadSaeiGame(miniGameDiv);
                    break;
                case 4: // Ø§Ù„ÙˆÙ‚ÙˆÙ Ø¨Ø¹Ø±ÙØ©
                    loadArafatGame(miniGameDiv);
                    break;
                case 5: // Ø§Ù„Ù…Ø¨ÙŠØª Ø¨Ù…Ø²Ø¯Ù„ÙØ©
                    loadMuzdalifaGame(miniGameDiv);
                    break;
                case 6: // Ø±Ù…ÙŠ Ø§Ù„Ø¬Ù…Ø±Ø§Øª
                    loadJamaratGame(miniGameDiv);
                    break;
                case 7: // Ø§Ù„Ù‡Ø¯ÙŠ ÙˆØ§Ù„ØªØ­Ù„Ù„
                    loadHadyGame(miniGameDiv);
                    break;
                case 8: // Ø·ÙˆØ§Ù Ø§Ù„Ø¥ÙØ§Ø¶Ø©
                    loadTawafGame(miniGameDiv, 'ifadaTawafCounter', 7, 'selectedRitual.gameCompleted = true;');
                    break;
                case 9: // Ø·ÙˆØ§Ù Ø§Ù„ÙˆØ¯Ø§Ø¹
                    loadTawafGame(miniGameDiv, 'wadaTawafCounter', 7, 'selectedRitual.gameCompleted = true;');
                    break;
                case 10: // Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø­Ø¬ - No game needed, automatic completion
                    loadCompletionGame(miniGameDiv);
                    selectedRitual.gameCompleted = true; // Mark as completed instantly
                    document.getElementById('completeBtn').textContent = 'Ø¥ØªÙ…Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†Ø³Ùƒ';
                    document.getElementById('completeBtn').disabled = false;
                    document.getElementById('completeBtn').style.opacity = '1';
                    break;
                default:
                    miniGameDiv.innerHTML = '<p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù„Ø¹Ø¨Ø© ØªÙØ§Ø¹Ù„ÙŠØ© Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†Ø³Ùƒ Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†.</p>';
            }

            // If the ritual was already completed, the game is also considered completed
            if (ritual.completed) {
                 completeBtn.textContent = 'ØªÙ… Ø¥ØªÙ…Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†Ø³Ùƒ';
                 completeBtn.disabled = true;
                 completeBtn.style.opacity = '0.5';
            } else if (ritual.gameCompleted) { // If game was completed but ritual not yet, enable button
                completeBtn.textContent = 'Ø¥ØªÙ…Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†Ø³Ùƒ';
                completeBtn.disabled = false;
                completeBtn.style.opacity = '1';
            }
        }

        // Game for Ihram (Id: 1)
        function loadIhramGame(container) {
            container.innerHTML = `
                <h4>ğŸ¤² Ù„Ø¹Ø¨Ø© Ø§Ù„Ø¥Ø­Ø±Ø§Ù…: Ø§Ø®ØªØ± Ù…Ù„Ø§Ø¨Ø³ Ø§Ù„Ø¥Ø­Ø±Ø§Ù… Ø§Ù„ØµØ­ÙŠØ­Ø©</h4>
                <p>Ø£ÙŠ Ù…Ù† Ø§Ù„ØªØ§Ù„ÙŠ Ù‡Ùˆ Ø§Ù„Ù„Ø¨Ø§Ø³ Ø§Ù„ØµØ­ÙŠØ­ Ù„Ù„Ø±Ø¬Ù„ Ø§Ù„Ù…Ø­Ø±Ù…ØŸ</p>
                <div style="margin: 20px 0;">
                    <button class="choice-button" onclick="checkIhramChoice(this, true)">Ø¥Ø²Ø§Ø± ÙˆØ±Ø¯Ø§Ø¡ Ø£Ø¨ÙŠØ¶ÙŠÙ†</button>
                    <button class="choice-button" onclick="checkIhramChoice(this, false)">Ù…Ù„Ø§Ø¨Ø³ Ù…Ù„ÙˆÙ†Ø© Ø¹Ø§Ø¯ÙŠØ©</button>
                    <button class="choice-button" onclick="checkIhramChoice(this, false)">Ø«ÙˆØ¨ ÙˆÙ‚Ø¨Ø¹Ø©</button>
                </div>
            `;
            ihramAnswered = false; // Reset for new game load
        }

        function checkIhramChoice(button, isCorrect) {
            if (ihramAnswered) return; // Prevent multiple answers
            ihramAnswered = true;

            const buttons = document.querySelectorAll('#miniGame .choice-button');
            buttons.forEach(btn => btn.disabled = true); // Disable all buttons

            if (isCorrect) {
                button.classList.add('correct');
                showFeedback('ØµØ­ÙŠØ­! Ù‡Ø°Ù‡ Ù‡ÙŠ Ù…Ù„Ø§Ø¨Ø³ Ø§Ù„Ø¥Ø­Ø±Ø§Ù… Ø§Ù„ØµØ­ÙŠØ­Ø© Ù„Ù„Ø±Ø¬Ù„.', 'success');
                gameScore += 10;
                selectedRitual.gameCompleted = true;
            } else {
                button.classList.add('incorrect');
                showFeedback('Ø®Ø·Ø£. Ø§Ø®ØªØ± Ø§Ù„Ù…Ù„Ø§Ø¨Ø³ Ø§Ù„Ø¨ÙŠØ¶Ø§Ø¡ Ø§Ù„Ø¨Ø³ÙŠØ·Ø© Ø§Ù„Ù…Ø®ØµØµØ© Ù„Ù„Ø¥Ø­Ø±Ø§Ù….', 'error');
                gameScore -= 5;
            }
            document.getElementById('scoreDisplay').textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${gameScore}`;
            document.getElementById('completeBtn').textContent = 'Ø¥ØªÙ…Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†Ø³Ùƒ';
            document.getElementById('completeBtn').disabled = false;
            document.getElementById('completeBtn').style.opacity = '1';
        }

        // Game for Tawaf (Id: 2, 8, 9) - Reusable function
        function loadTawafGame(container, counterId, requiredRounds, onCompleteJS) {
            let currentTawafRounds = 0;
            if (counterId === 'tawafCounter') currentTawafRounds = tawafRounds;
            else if (counterId === 'ifadaTawafCounter') currentTawafRounds = ifadaTawafRounds;
            else if (counterId === 'wadaTawafCounter') currentTawafRounds = wadaTawafRounds;

            container.innerHTML = `
                <h4>ğŸ•‹ Ù„Ø¹Ø¨Ø© Ø§Ù„Ø·ÙˆØ§Ù: Ø£ØªÙ… Ø³Ø¨Ø¹Ø© Ø£Ø´ÙˆØ§Ø· Ø­ÙˆÙ„ Ø§Ù„ÙƒØ¹Ø¨Ø©</h4>
                <div class="tawaf-circle">
                    <div class="kaaba"></div>
                    <div class="pilgrim" id="pilgrim" style="transform: translateX(-50%) rotate(${pilgrimAngle}deg);"></div>
                </div>
                <p>Ø£Ø´ÙˆØ§Ø· Ø§Ù„Ø·ÙˆØ§Ù Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©: <span id="${counterId}">${currentTawafRounds}</span> Ù…Ù† ${requiredRounds}</p>
                <button class="game-button" onclick="performTawafRound('${counterId}', ${requiredRounds}, '${onCompleteJS}')">Ø·ÙØª Ø´ÙˆØ·Ø§Ù‹</button>
            `;
            updatePilgrimPosition(pilgrimAngle); // Set initial position
            updateTawafDisplay(counterId, requiredRounds);
        }

        function updatePilgrimPosition(currentAngle) {
            const pilgrim = document.getElementById('pilgrim');
            if (pilgrim) {
                // Keep translateX(-50%) to center the pilgrim horizontally, then apply rotation
                pilgrim.style.transform = `translateX(-50%) rotate(${currentAngle}deg)`;
            }
        }

        function performTawafRound(counterId, requiredRounds, onCompleteJS) {
            if (selectedRitual.completed) return;

            if (counterId === 'tawafCounter') tawafRounds++;
            else if (counterId === 'ifadaTawafCounter') ifadaTawafRounds++;
            else if (counterId === 'wadaTawafCounter') wadaTawafRounds++;

            const currentRounds = (counterId === 'tawafCounter' ? tawafRounds : 
                                  (counterId === 'ifadaTawafCounter' ? ifadaTawafRounds : wadaTawafRounds));
            
            pilgrimAngle += (degreesPerRound / requiredRounds); // Increment angle for visual rotation
            if (pilgrimAngle >= 360) pilgrimAngle -= 360; // Keep angle within 0-359

            updatePilgrimPosition(pilgrimAngle);
            updateTawafDisplay(counterId, requiredRounds);

            if (currentRounds >= requiredRounds) {
                showFeedback('Ø£Ø­Ø³Ù†Øª! Ù„Ù‚Ø¯ Ø£ØªÙ…Ù…Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø´ÙˆØ§Ø·.', 'success');
                gameScore += 10;
                eval(onCompleteJS); // Mark game as completed
                document.getElementById('completeBtn').textContent = 'Ø¥ØªÙ…Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†Ø³Ùƒ';
                document.getElementById('completeBtn').disabled = false;
                document.getElementById('completeBtn').style.opacity = '1';
                document.querySelector('.game-button').disabled = true; // Disable further clicks
            } else {
                showFeedback(`Ø¨Ù‚ÙŠ Ù„Ùƒ ${requiredRounds - currentRounds} Ø£Ø´ÙˆØ§Ø·.`, 'info');
                gameScore += 1; // Small score for each round
            }
            document.getElementById('scoreDisplay').textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${gameScore}`;
        }

        function updateTawafDisplay(counterId, requiredRounds) {
            const counterElement = document.getElementById(counterId);
            if (counterElement) {
                 const currentRounds = (counterId === 'tawafCounter' ? tawafRounds : 
                                  (counterId === 'ifadaTawafCounter' ? ifadaTawafRounds : wadaTawafRounds));
                counterElement.textContent = `${currentRounds}`;
            }
        }

        // Game for Saei (Id: 3)
        function loadSaeiGame(container) {
            saeiRounds = 0;
            container.innerHTML = `
                <h4>ğŸš¶â€â™‚ï¸ Ù„Ø¹Ø¨Ø© Ø§Ù„Ø³Ø¹ÙŠ: Ø£ØªÙ… Ø³Ø¨Ø¹Ø© Ø£Ø´ÙˆØ§Ø· Ø¨ÙŠÙ† Ø§Ù„ØµÙØ§ ÙˆØ§Ù„Ù…Ø±ÙˆØ©</h4>
                <p>Ø£Ø´ÙˆØ§Ø· Ø§Ù„Ø³Ø¹ÙŠ Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©: <span id="saeiCounter">0</span> Ù…Ù† 7</p>
                <button class="game-button" onclick="performSaeiRound()">Ø³Ø¹ÙŠØª Ø´ÙˆØ·Ø§Ù‹</button>
            `;
            updateSaeiDisplay();
        }

        function performSaeiRound() {
            if (selectedRitual.completed) return;
            saeiRounds++;
            updateSaeiDisplay();

            if (saeiRounds >= 7) {
                showFeedback('Ø£Ø­Ø³Ù†Øª! Ù„Ù‚Ø¯ Ø£ØªÙ…Ù…Øª Ø§Ù„Ø³Ø¹ÙŠ Ø¨ÙŠÙ† Ø§Ù„ØµÙØ§ ÙˆØ§Ù„Ù…Ø±ÙˆØ©.', 'success');
                gameScore += 10;
                selectedRitual.gameCompleted = true;
                document.getElementById('completeBtn').textContent = 'Ø¥ØªÙ…Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†Ø³Ùƒ';
                document.getElementById('completeBtn').disabled = false;
                document.getElementById('completeBtn').style.opacity = '1';
                document.querySelector('.game-button').disabled = true;
            } else {
                showFeedback(`Ø¨Ù‚ÙŠ Ù„Ùƒ ${7 - saeiRounds} Ø£Ø´ÙˆØ§Ø·.`, 'info');
                gameScore += 1;
            }
            document.getElementById('scoreDisplay').textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${gameScore}`;
        }

        function updateSaeiDisplay() {
            document.getElementById('saeiCounter').textContent = saeiRounds;
        }

        // Game for Arafat (Id: 4)
        function loadArafatGame(container) {
            arafatPrayed = false;
            arafatPrayTime = 0;
            if (arafatTimer) clearInterval(arafatTimer); // Clear any existing timer
            container.innerHTML = `
                <h4>ğŸŒ… Ù„Ø¹Ø¨Ø© Ø¹Ø±ÙØ©: Ø§Ø³ØªÙ…Ø± ÙÙŠ Ø§Ù„Ø¯Ø¹Ø§Ø¡ ÙˆØ§Ù„Ø°ÙƒØ± Ù„Ù…Ø¯Ø© 30 Ø«Ø§Ù†ÙŠØ©</h4>
                <p>ÙˆÙ‚Øª Ø§Ù„Ø¯Ø¹Ø§Ø¡ ÙˆØ§Ù„Ø°ÙƒØ± Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: <span id="arafatTimerDisplay">30</span> Ø«Ø§Ù†ÙŠØ©</p>
                <button class="game-button" id="startArafatPray" onclick="startArafatPraying()">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¯Ø¹Ø§Ø¡ ÙˆØ§Ù„Ø°ÙƒØ±</button>
            `;
        }

        function startArafatPraying() {
            if (selectedRitual.completed || arafatPrayed) return;

            const startBtn = document.getElementById('startArafatPray');
            startBtn.disabled = true;
            startBtn.textContent = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¯Ø¹Ø§Ø¡...';
            startBtn.style.background = '#27ae60'; // Change color to indicate active

            const timerDisplay = document.getElementById('arafatTimerDisplay');
            arafatPrayTime = 0;
            timerDisplay.textContent = 30; // Initial display for countdown

            arafatTimer = setInterval(() => {
                arafatPrayTime++;
                const remainingTime = 30 - arafatPrayTime;
                timerDisplay.textContent = remainingTime;

                if (remainingTime <= 0) {
                    clearInterval(arafatTimer);
                    arafatTimer = null;
                    arafatPrayed = true;
                    showFeedback('Ø£Ø­Ø³Ù†Øª! Ù„Ù‚Ø¯ Ø£ØªÙ…Ù…Øª Ø§Ù„ÙˆÙ‚ÙˆÙ Ø¨Ø¹Ø±ÙØ© ÙˆØ§Ù„Ø¯Ø¹Ø§Ø¡.', 'success');
                    gameScore += 20;
                    selectedRitual.gameCompleted = true;
                    document.getElementById('completeBtn').textContent = 'Ø¥ØªÙ…Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†Ø³Ùƒ';
                    document.getElementById('completeBtn').disabled = false;
                    document.getElementById('completeBtn').style.opacity = '1';
                    startBtn.textContent = 'ØªÙ… Ø§Ù„Ø¯Ø¹Ø§Ø¡';
                    startBtn.style.background = '#27ae60';
                }
                document.getElementById('scoreDisplay').textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${gameScore}`;
            }, 1000); // Update every second
        }

        // Game for Muzdalifa (Id: 5)
        function loadMuzdalifaGame(container) {
            muzdalifaCollected = 0;
            container.innerHTML = `
                <h4>ğŸŒ™ Ù„Ø¹Ø¨Ø© Ù…Ø²Ø¯Ù„ÙØ©: Ø§Ø¬Ù…Ø¹ 49 Ø­ØµØ§Ø© Ù„Ø±Ù…ÙŠ Ø§Ù„Ø¬Ù…Ø±Ø§Øª</h4>
                <p>Ø¹Ø¯Ø¯ Ø§Ù„Ø­ØµÙ‰ Ø§Ù„Ù…Ø¬Ù…Ø¹Ø©: <span id="muzdalifaCounter">0</span> Ù…Ù† 49</p>
                <div class="stone-container" id="stoneContainer">
                </div>
                <button class="game-button" onclick="generateStones()">Ø§Ø¨Ø¯Ø£ Ø¬Ù…Ø¹ Ø§Ù„Ø­ØµÙ‰</button>
            `;
            // Initial render of stones (empty for now, generated by button click)
            document.getElementById('muzdalifaCounter').textContent = muzdalifaCollected;
        }

        function generateStones() {
            const stoneContainer = document.getElementById('stoneContainer');
            stoneContainer.innerHTML = '';
            // Generate some stones, for simplicity let's generate 49 clickable stones directly
            // In a real game, you might generate fewer and have them reappear or generate dynamically
            for (let i = 0; i < 49; i++) {
                const stone = document.createElement('div');
                stone.className = 'stone';
                stone.textContent = 'ğŸª¨'; // Emoji for stone
                stone.onclick = function() { collectStone(this); };
                stoneContainer.appendChild(stone);
            }
            document.querySelector('.game-button').disabled = true; // Disable generate button after first click
            showFeedback('Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø­ØµÙ‰ Ù„Ø¬Ù…Ø¹Ù‡Ø§.', 'info');
        }

        function collectStone(stoneElement) {
            if (stoneElement.classList.contains('collected') || selectedRitual.completed) return;

            stoneElement.classList.add('collected');
            muzdalifaCollected++;
            document.getElementById('muzdalifaCounter').textContent = muzdalifaCollected;
            gameScore += 1;

            if (muzdalifaCollected >= 49) {
                showFeedback('Ø£Ø­Ø³Ù†Øª! Ù„Ù‚Ø¯ Ø¬Ù…Ø¹Øª Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„ÙƒØ§ÙÙŠ Ù…Ù† Ø§Ù„Ø­ØµÙ‰.', 'success');
                gameScore += 15;
                selectedRitual.gameCompleted = true;
                document.getElementById('completeBtn').textContent = 'Ø¥ØªÙ…Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†Ø³Ùƒ';
                document.getElementById('completeBtn').disabled = false;
                document.getElementById('completeBtn').style.opacity = '1';
                // Disable all remaining stones
                document.querySelectorAll('#stoneContainer .stone').forEach(s => s.onclick = null);
            }
            document.getElementById('scoreDisplay').textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${gameScore}`;
        }

        // Game for Jamarat (Id: 6)
        function loadJamaratGame(container) {
            jamaratThrown = 0;
            container.innerHTML = `
                <h4>â›°ï¸ Ù„Ø¹Ø¨Ø© Ø±Ù…ÙŠ Ø§Ù„Ø¬Ù…Ø±Ø§Øª: Ø§Ø±Ù…Ù Ø³Ø¨Ø¹ Ø­ØµÙŠØ§Øª Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ù…Ø±Ø© Ø§Ù„ÙƒØ¨Ø±Ù‰</h4>
                <p>Ø¹Ø¯Ø¯ Ø§Ù„Ø­ØµÙŠØ§Øª Ø§Ù„Ù…Ø±Ù…ÙŠØ©: <span id="jamaratCounter">0</span> Ù…Ù† 7</p>
                <div class="jamrat" id="jamratTarget" onclick="throwStone()">Ø§Ù„Ø¬Ù…Ø±Ø©</div>
                <p>Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ù…Ø±Ø© Ù„Ø±Ù…ÙŠ Ø§Ù„Ø­ØµÙ‰.</p>
            `;
            document.getElementById('jamaratCounter').textContent = jamaratThrown;
        }

        function throwStone() {
            if (jamaratThrown >= 7 || selectedRitual.completed) return;

            jamaratThrown++;
            document.getElementById('jamaratCounter').textContent = jamaratThrown;
            gameScore += 5;

            const jamratTarget = document.getElementById('jamratTarget');
            jamratTarget.classList.add('hit');
            // Remove 'hit' class after animation to allow re-triggering
            setTimeout(() => {
                jamratTarget.classList.remove('hit');
            }, 500);

            if (jamaratThrown >= 7) {
                showFeedback('Ø£Ø­Ø³Ù†Øª! Ù„Ù‚Ø¯ Ø£ØªÙ…Ù…Øª Ø±Ù…ÙŠ Ø¬Ù…Ø±Ø© Ø§Ù„Ø¹Ù‚Ø¨Ø© Ø§Ù„ÙƒØ¨Ø±Ù‰.', 'success');
                gameScore += 15;
                selectedRitual.gameCompleted = true;
                document.getElementById('completeBtn').textContent = 'Ø¥ØªÙ…Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†Ø³Ùƒ';
                document.getElementById('completeBtn').disabled = false;
                document.getElementById('completeBtn').style.opacity = '1';
                jamratTarget.onclick = null; // Disable further throwing
            } else {
                showFeedback(`Ø¨Ù‚ÙŠ Ù„Ùƒ ${7 - jamaratThrown} Ø­ØµÙŠØ§Øª.`, 'info');
            }
            document.getElementById('scoreDisplay').textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${gameScore}`;
        }

        // Game for Hady and Tahallul (Id: 7)
        function loadHadyGame(container) {
            hadyDone = false;
            container.innerHTML = `
                <h4>âœ‚ï¸ Ù„Ø¹Ø¨Ø© Ø§Ù„Ù‡Ø¯ÙŠ ÙˆØ§Ù„ØªØ­Ù„Ù„: Ø§Ø®ØªØ± Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„ØµØ­ÙŠØ­</h4>
                <p>Ù…Ø§Ø°Ø§ ØªÙØ¹Ù„ Ø¨Ø¹Ø¯ Ø±Ù…ÙŠ Ø¬Ù…Ø±Ø© Ø§Ù„Ø¹Ù‚Ø¨Ø© Ø§Ù„ÙƒØ¨Ø±Ù‰ØŸ</p>
                <div class="hady-choice-container">
                    <button id="choiceHady" onclick="selectHadyAction(this, 'hady')">Ø°Ø¨Ø­ Ø§Ù„Ù‡Ø¯ÙŠ (Ø¥Ø°Ø§ ÙˆØ¬Ø¨)</button>
                    <button id="choiceHair" onclick="selectHadyAction(this, 'hair')">Ø­Ù„Ù‚ Ø£Ùˆ ØªÙ‚ØµÙŠØ± Ø§Ù„Ø´Ø¹Ø±</button>
                    <button id="choiceBoth" onclick="selectHadyAction(this, 'both')">Ø§Ù„Ù‚ÙŠØ§Ù… Ø¨ÙƒÙ„ÙŠÙ‡Ù…Ø§ (Ø§Ù„Ø°Ø¨Ø­ ÙˆØ§Ù„Ø­Ù„Ù‚/Ø§Ù„ØªÙ‚ØµÙŠØ±)</button>
                    <button id="choiceNone" onclick="selectHadyAction(this, 'none')">Ù„Ø§ Ø´ÙŠØ¡</button>
                </div>
            `;
        }

        function selectHadyAction(button, actionType) {
            if (hadyDone || selectedRitual.completed) return;

            const buttons = document.querySelectorAll('.hady-choice-container button');
            buttons.forEach(btn => {
                btn.disabled = true;
                btn.classList.remove('selected');
            });
            button.classList.add('selected');

            let isCorrect = false;
            if (actionType === 'both') { // Assuming the pilgrim should do both if applicable
                isCorrect = true;
            } else if (actionType === 'hady' && selectedRitual.detailedDescription.includes("Ø¥Ù† ÙˆØ¬Ø¨ Ø¹Ù„ÙŠÙ‡")) { // Simplified: check if desc mentions "if required"
                isCorrect = true; // Could be correct if only hady is required/chosen
            } else if (actionType === 'hair' && !selectedRitual.detailedDescription.includes("Ø¥Ù† ÙˆØ¬Ø¨ Ø¹Ù„ÙŠÙ‡")) { // Simplified: if hady not mentioned as required, hair is correct
                isCorrect = true;
            }


            if (isCorrect) {
                showFeedback('ØµØ­ÙŠØ­! Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„ØµØ­ÙŠØ­ Ù„Ù„ØªØ­Ù„Ù„.', 'success');
                gameScore += 15;
                hadyDone = true;
                selectedRitual.gameCompleted = true;
                document.getElementById('completeBtn').textContent = 'Ø¥ØªÙ…Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†Ø³Ùƒ';
                document.getElementById('completeBtn').disabled = false;
                document.getElementById('completeBtn').style.opacity = '1';
            } else {
                showFeedback('Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©. Ø±Ø§Ø¬Ø¹ Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ù„Ù…Ø¹Ø±ÙØ© Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø©.', 'error');
                gameScore -= 5;
                // Allow user to try again if incorrect
                buttons.forEach(btn => btn.disabled = false);
                button.classList.remove('selected');
                hadyDone = false; // Allow re-attempt
            }
            document.getElementById('scoreDisplay').textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${gameScore}`;
        }

        // Game for Completion (Id: 10) - Simple message
        function loadCompletionGame(container) {
            container.innerHTML = `
                <h4>ğŸŠ ØªÙ‡Ø§Ù†ÙŠÙ†Ø§!</h4>
                <p>Ù„Ù‚Ø¯ Ø£ØªÙ…Ù…Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ ÙˆØ§Ù„Ù…Ù†Ø§Ø³Ùƒ Ø¨Ù†Ø¬Ø§Ø­. Ø£Ù†Øª Ø§Ù„Ø¢Ù† Ù…Ø³ØªØ¹Ø¯ Ù„Ø¥ÙƒÙ…Ø§Ù„ Ø±Ø­Ù„Ø© Ø§Ù„Ø­Ø¬!</p>
            `;
        }


        // Initialize the game when the script loads
        document.addEventListener('DOMContentLoaded', initializeGame);
    </script>
</body>
</html>